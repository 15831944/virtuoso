// Copyright 2005 Microsoft Corporation
/* 
	added E.coords = bU for coords acessibility 
	fixed em(a) to be Standard Compliance Mode compatible: "px" suffix for position values, if not present
*/
function ar(b){return b?b:window.event;}function aG(b){b.cancelBubble=true;}function G(b){b=ar(b);aG(b);return false;}function bl(b){var gZ=0;if(b.pageX){gZ=b.pageX;}else if(b.clientX){if(document.documentElement&&document.documentElement.scrollLeft){gZ=b.clientX+document.documentElement.scrollLeft;}else if(document.body){gZ=b.clientX+document.body.scrollLeft;}}return gZ;}function ce(b){var gY=0;if(b.pageY){gY=b.pageY;}else if(b.clientY){if(document.documentElement&&document.documentElement.scrollTop){gY=b.clientY+document.documentElement.scrollTop;}else if(document.body){gY=b.clientY+document.body.scrollTop;}}return gY;}function jS(b){if(b.wheelDelta){return b.wheelDelta;}else if(b.detail){return-b.detail;}return 0;}function rI(b){if(!b){b=window.event;}var U=null;if(b.srcElement){U=b.srcElement;}else if(b.target){U=b.target;}if(U&&U.nodeType){if(U.nodeType==3){U=rO.parentNode;}}return U;}function iU(aZ){var cy=aZ;var jh=0;while(cy){jh+=cy.offsetLeft;cy=cy.offsetParent;}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof(document.body.leftMargin)!="undefined"){jh+=document.body.leftMargin;}return jh;}function gJ(aZ){var cy=aZ;var hL=0;while(cy){hL+=cy.offsetTop;cy=cy.offsetParent;}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof(document.body.topMargin)!="undefined"){hL+=document.body.topMargin;}return hL;}function ak(d){return Math.floor(d);}function cw(d){return Math.ceil(d);}function dV(d,f){return Math.max(d,f);}function dR(d,f){return Math.min(d,f);}function aW(d){return Math.abs(d);}function aj(d){return Math.round(d);}function cp(aM){return aM*Math.PI/180.0;}function ho(no){return no*180.0/Math.PI;}function ma(af,W){if(!af||!W||af[0].length!=W.length){return;}var p=af.length;var q=W[0].length;var aU=new Array(p);var bn=W.length;for(var a=0;a<p;a++){aU[a]=new Array(q);for(var Y=0;Y<q;Y++){aU[a][Y]=0;for(var gU=0;gU<bn;gU++){aU[a][Y]+=af[a][gU]*W[gU][Y];}}}return aU;}function RegisterNamespaces(){for(var a=0;a<arguments.length;a++){var gV=arguments[a].split(".");var gO=window;for(var Y=0;Y<gV.length;Y++){if(!gO[gV[Y]]){gO[gV[Y]]=new Object();}gO=gO[gV[Y]];}}}RegisterNamespaces("Msn.VE");
Msn.VE.MapControl=function(x,V){var eQ=20971520;var jr=163840;var bM=0;var ej=true;var ct=6;var me=15;var lD=15;var bf=6378137;var gc=bf*2.0*Math.PI;var fJ=gc*0.5;var fM=1;var fj=19;var pk="http://virtualearth.msn.com/i/spacer.gif";var jI=-85;var mT=85;var lT=-180;var lf=180;var H=256;var dT=new Object();var qk=0;var nJ=0;var mi=1;var ld=1;var gw=2;var oh=3;var gw=11;var qS=20;var h=this;var dd='r';var dU='h';var eW='a';var aN='o';var c=new Msn.VE.MapView();var at=new Msn.VE.MapView();var kz=1;var rf=null;var hB=15;var hW=dd;var d=0,f=0,q=0,p=0;var I=new Array();var cE=null;var K=0,M=0;var ai=0,ah=0;var bY=0,bN=0;var cj=0,cm=0;var aK=0,cf=0;var cW=false;var iO=false;var iT=0,iJ=0;var bh=false;var cS=0;var aQ=false;var gb=0;var fS=0,fR=0;var eM=null,fL=null;var an=new Array();var bc=new Array();var i=document.createElement("div");var cb=document.createElement("input");cb.id="wl_ve_mapInput";var dv=null;var bX=null;var cq=null;var N=null;var et=null;var cP=null;var dG=null;var cU=null;var dn=null;var z=null;var y=null;var hP=null;var dw=new Array();var fV=false;this.Init=function(){dT[dd]=22;dT[eW]=22;dT[dU]=22;dT[aN]=24;dn=new oI();dn.Init();if(V.obliqueEnabled&&V.obliqueUrl){z=new rr();z.Init(V.obliqueUrl);}ku();i.className="Map";i.style.zIndex=mi;x.appendChild(i);cb.className="KeyboardInput";x.appendChild(cb);if(!V.fixedView){cP=new oj();cP.Init();dG=new pH();dG.Init();cU=dG;x.attachEvent("onmousedown",cR);x.attachEvent("onmouseup",bD);x.attachEvent("onmousemove",cL);x.attachEvent("onmousewheel",eo);x.attachEvent("ondblclick",mp);x.attachEvent("oncontextmenu",mo);cb.attachEvent("onkeydown",mv);cb.attachEvent("onkeyup",jv);if(window.addEventListener&&navigator.product&&navigator.product=="Gecko"){x.addEventListener("DOMMouseScroll",eo,false);}bM=H;}if(V.buffer!=undefined&&V.buffer!=null){bM=V.buffer;}if(V.latitude&&V.longitude&&V.zoomlevel&&V.mapstyle){try{var ha=new Msn.VE.MapView();ha.SetMapStyle(lC(V.mapstyle),V.obliqueSceneId);ha.SetZoomLevel(eval(V.zoomlevel));ha.SetCenterLatLong(new Msn.VE.LatLong(eval(V.latitude),eval(V.longitude)));au(ha);}catch(dl){jT();}}else{jT();}if(!V.disableLogo){dv=new nP(x);dv.Init();}cq=new qa(x);cq.Init();if(V.showScaleBar){bX=new qo(x);bX.Init();dY("onendzoom",bX.Update);dY("onendcontinuouspan",bX.Update);dY("onresize",bX.Reposition);}if(V.showDashboard){pt(V.dashboardX,V.dashboardY,V.dashboardSize);}if(z&&y!=z){z.UpdateAvailability();}};this.GetDashboard=function(){return et;};this.Destroy=function(){if(!V.fixedView){x.detachEvent("onmousedown",cR);x.detachEvent("onmouseup",bD);x.detachEvent("onmousemove",cL);x.detachEvent("onmousewheel",eo);x.detachEvent("ondblclick",mp);x.detachEvent("oncontextmenu",mo);cb.detachEvent("onkeydown",mv);cb.detachEvent("onkeyup",jv);}while(I.length>0){var ad=I.pop();ad.RemoveFromMap();}I=null;while(an.length){an.pop().Destroy();}an=null;jD();if(et){et.Destroy();et=null;}if(N){N.detachEvent("onmousedown",G);N.detachEvent("onmouseup",G);N.detachEvent("onmousemove",G);N.detachEvent("onmousewheel",G);N.detachEvent("ondblclick",G);N.detachEvent("oncontextmenu",G);N.detachEvent("onkeydown",G);N.detachEvent("onkeyup",G);x.removeChild(N);N=null;}if(bX){ev("onendzoom",bX.Update);ev("onendcontinuouspan",bX.Update);ev("onresize",bX.Reposition);bX.Destroy();bX=null;}if(dv){dv.Destroy();dv=null;}if(cq){cq.Destroy();cq=null;}if(dn){dn.Destroy();dn=null;}if(z){z.Destroy();z=null;}if(cP){cP.Destroy();cP=null;}if(dG){dG.Destroy();dG=null;}nS();x=h=null;};function ku(){d=iU(x);f=gJ(x);q=x.offsetWidth;p=x.offsetHeight;}function pt(d,f,aV){if(!aV){aV=Msn.VE.DashboardSize.Normal;}if(aV==Msn.VE.DashboardSize.Tiny){aV=Msn.VE.DashboardSize.Small;}N=document.createElement("div");x.appendChild(N);N.id="mapnavdashboard";N.className="Dashboard Dashboard_"+aV;N.style.top=f+"px";N.style.left=d+"px";N.attachEvent("onmousedown",G);N.attachEvent("onmouseup",G);N.attachEvent("onmousemove",G);N.attachEvent("onmousewheel",G);N.attachEvent("ondblclick",G);N.attachEvent("oncontextmenu",G);N.attachEvent("onkeydown",G);N.attachEvent("onkeyup",G);et=new Msn.VE.Dashboard(N,h,aV);et.Init();}function jT(){var e=new Msn.VE.MapView();e.SetCenterLatLong(new Msn.VE.LatLong(0.0,0.0));e.SetZoomLevel(1);e.SetMapStyle(dd);au(e);}function jj(A,J){var e=at.MakeCopy();e.SetCenterLatLong(new Msn.VE.LatLong(A,J));au(e);}function cg(aa,bV,iq){var e=c.MakeCopy();e.SetMapStyle(lC(aa),bV,iq);if(c.mapStyle!=aa){if(aa==aN){e.SetZoomLevel(1);hB=c.zoomLevel;hW=c.mapStyle;}else if(c.mapStyle==aN){e.SetZoomLevel(hB);}}au(e);}function lC(aa){if(aa==eW||aa==dU||aa==aN){return aa;}else{return dd;}}function oY(){return c.latlong.latitude;}function pL(){return c.latlong.longitude;}function lU(qv){c.latlong=y.PixelToLatLong(c.center,c.zoomLevel);if(qv){at.Copy(c);}if(z){z.UpdateAvailability();}}function iL(f){var l=new Msn.VE.Pixel(K+ai+q/2,M+ah+f);var o=y.PixelToLatLong(l,c.zoomLevel);if(!o){return null;}return o.latitude;}function hv(d){var l=new Msn.VE.Pixel(K+ai+d,M+ah+p/2);var o=y.PixelToLatLong(l,c.zoomLevel);if(!o){return null;}return o.longitude;}function iZ(A){var o=new Msn.VE.LatLong(A,c.center.longitude);var l=y.LatLongToPixel(o,c.zoomLevel);if(!l){return null;}return aj(l.y-M-ah);}function jc(J){var o=new Msn.VE.LatLong(c.center.latitude,J);var l=y.LatLongToPixel(o,c.zoomLevel);if(!l){return null;}return aj(l.x-K-ai);}function cM(o){var l=y.LatLongToPixel(o,c.zoomLevel);l.x-=K+ai;l.y-=M+ah;return l;}function dj(l){var oM=new Msn.VE.Pixel(l.x+K+ai,l.y+M+ah);var o=y.PixelToLatLong(oM,c.zoomLevel);return o;}function nq(){return c.zoomLevel;}function ok(){return c.mapStyle;}function mK(A,m){if(!A){A=c.latlong.latitude;}if(!m){m=c.zoomLevel;}return Math.cos(cp(A))*y.MetersPerPixel(m);}function rm(aJ,aI){if(!aJ||!aI||aJ<=0||aI<=0){return;}q=aJ;p=aI;x.style.width=q;x.style.height=p;pu(c);cq.Reposition();if(dv){dv.Reposition();}ap("onresize");}function oZ(){return z?z.IsAvailable():false;}function rg(){return z?z.GetScene():null;}function ph(dQ){ej=dQ;}function oz(){return ej;}function qL(F){if(z){cg(aN,F,null);}}function og(eH){if(z){cg(aN,null,eH);}}function iy(aM){fV=aM;for(var a=0;a<I.length;a++){I[a].Debug(aM);}}function na(e,t){lY(e,t,0,0);}function lY(e,t,br,bu){br=lm(br,q,e.center.x-q/2,e.zoomLevel,t.z1,t.x1,t.x2);bu=lm(bu,p,e.center.y-p/2,e.zoomLevel,t.z1,t.y1,t.y2);e.SetCenter(new Msn.VE.Pixel(e.center.x+br,e.center.y+bu));}function lm(co,aV,fB,m,kJ,pE,rx){var dx=H*pE*Math.pow(2,m-kJ);var aA=H*rx*Math.pow(2,m-kJ);if(aV>(aA-dx)){return((aA-dx-aV)/2)-fB+dx;}else if(fB+co<dx){return dx-fB;}else if(fB+aV+co>aA){return aA-fB-aV;}return co;}function qa(L){var aw=document.createElement("div");var ae=document.createElement("div");var eJ=13;this.Init=function(){aw.className="Copyright CopyrightBackground";ae.className="Copyright CopyrightForeground";bA();L.appendChild(aw);L.appendChild(ae);};this.Destroy=function(){L.removeChild(aw);L.removeChild(ae);aw=ae=null;};function bA(){aw.style.top=(p-eJ)+"px";aw.style.left=(q-234)+"px";aw.style.display="block";ae.style.top=(p-eJ-1)+"px";ae.style.left=(q-235)+"px";ae.style.display="block";}function cl(){var k="&copy; 2005 Microsoft Corp";eJ=13;if(c.zoomLevel>=5&&(c.mapStyle==dd||c.mapStyle==dU)){k+=" &nbsp; &copy; 2004 NAVTEQ";}if(c.mapStyle==dU||c.mapStyle==eW){k+="<br>";eJ=21;if(c.zoomLevel<=8){k+="Image courtesy of NASA";}else if(c.zoomLevel<=13){k+="&copy; Harris Corp, Earthstar Geographics LLC";}else{k+="Image courtesy of USGS";}}else if(c.mapStyle==aN){k+="<br>&copy; 2005 Pictometry International Corp.";eJ=21;}aw.innerHTML=k;ae.innerHTML=k;bA();}this.Reposition=bA;this.Update=cl;}function nL(e,gm,fr){this.view=e;this.oblique=gm;this.error=fr;}function fN(o,m,fr){var e=c.MakeCopy();if(o!=undefined){e.latlong=o;}if(m!=undefined){e.zoomLevel=m;}if(fr==undefined){fr="";}var gm=null;if(z){gm=z.GetEventInfo();}return new nL(e,gm,fr);}function dY(aP,de){var am=dw[aP];if(!am){am=new Array();dw[aP]=am;}for(var a=0;a<am.length;a++){if(am[a]==de){return true;}}am.push(de);}function ev(aP,de){var am=dw[aP];if(!am){return;}for(var a=0;a<am.length;a++){if(am[a]==de){am.splice(a,1);}}}function ap(aP,hF){var am=dw[aP];if(!am){return;}if(!hF){hF=fN();}for(var a=0;a<am.length;a++){am[a](hF);}}function nS(){while(dw.length){var am=dw.pop();while(am.length){am.pop();}am=null;}dw=null;}function mv(b){b=ar(b);var s=me;var d=fS;var f=fR;switch(b.keyCode){case 9:if(aQ&&iO){fh();}return true;case 37:d=-s;break;case 38:f=-s;break;case 39:d=s;break;case 40:f=s;break;case 107:case 187:case 61:case 43:d=0;f=0;gL();break;case 109:case 189:d=0;f=0;fU();break;case 65:d=0;f=0;cg(eW);break;case 72:d=0;f=0;cg(dU);break;case 82:case 86:d=0;f=0;cg(dd);break;case 66:case 79:d=0;f=0;cg(aN);break;default:return false;}if(d||f){gG(d,f,null,true);}return false;}function jv(b){b=ar(b);var d=fS;var f=fR;switch(b.keyCode){case 37:d=0;break;case 38:f=0;break;case 39:d=0;break;case 40:f=0;break;default:return false;}gG(d,f,null,true);return false;}var es=0;var ed=0;var ez=0;var eC=0;function qR(F,gn,hq,fn,dA,aT,cF,eq){if(F==null||gn==null||hq==null||cF==null||eq==null){return null;}var mS=new Array();for(var a=0;a<cF.length;a++){mS.push(jl(cF[a],0,cF[a].length-1));}var ew=new pG();ew.Init(F,gn,hq,fn,dA,aT,mS,eq);bc.push(ew);return ew;}function qz(F){for(var a=0;a<bc.length;a++){var ew=bc[a];if(ew.id==F){bc.splice(a,1);ew.Destroy();return;}}}function jD(){while(bc.length>0)bc.pop().Destroy();}function pV(){for(var a=0;a<bc.length;a++){bc[a].StartLine();bc[a].Show();}}function kc(){for(var a=0;a<bc.length;a++){bc[a].Hide();}}function op(){for(var a=0;a<bc.length;a++){bc[a].UpdateLine();}}function jl(fI,dN,eZ){var hA=eZ-dN+1;if(hA<1){return null;}else if(hA==1){return fI[dN];}var dB=null;var dk=null;if(hA==2){dB=fI[dN];dk=fI[eZ];}else{var a=Math.round((dN+eZ)/2);dB=jl(fI,dN,a);dk=jl(fI,a+1,eZ);}if(dB!=null&&dk!=null){var bC=dB.boundingRectangle;var bB=dk.boundingRectangle;var es=bC[0].latitude>bB[0].latitude?bC[0].latitude:bB[0].latitude;var eC=bC[0].longitude>bB[0].longitude?bC[0].longitude:bB[0].longitude;var ed=bC[1].latitude<bB[1].latitude?bC[1].latitude:bB[1].latitude;var ez=bC[1].longitude<bB[1].longitude?bC[1].longitude:bB[1].longitude;var pP=[new Msn.VE.LatLong(es,eC),new Msn.VE.LatLong(ed,ez)];return new Msn.VE.LineRegion(pP,null,[dB,dk]);}else if(dB!=null){return dB;}else if(dk!=null){return dk;}return null;}function pG(){var nV=6;var pb="#11DD11";var rR=4;var j=null;var lp="";var cG=true;var kr="";var mb="";var aT=0;var oK=0;var pj=0;var pc=0;var pA=0;var dF=null;var dr=null;var cF=null;var eq=null;var dN=0;var eZ=0;var dp=null;function pT(F,gn,hq,fn,dA,iB,oi,mU){if(!fn){fn=nV;}if(!dA){dA=pb;}if(!iB){iB=rQ;}this.id=F;lp=F;kr=fn+"pt";mb=dA;aT=iB;dF=gn;dr=hq;eq=mU;cF=oi;oK=dF[0];pj=dr[0];pc=dF[dF.length-1];pA=dr[dr.length-1];dp=c.MakeCopy();mk();};function bZ(){cK();dF=dr=cF=j=dp=null;};function cK(){if(j&&j.parentNode==i){i.removeChild(j);}}function aO(){if(!cG){as();return;}if(j){j.style.display="block";}};function as(){if(j){j.style.display="none";}};function pm(ol){cG=ol;if(!cG){as();}}function mk(){kP();lt();dp.Copy(c);}function pS(){if(c.zoomLevel==dp.zoomLevel&&aW((c.center.x-dp.center.x)/q)<0.25&&aW((c.center.y-dp.center.y)/p)<0.25){return;}kP();lt();dp=c.MakeCopy();;}function kP(){var kb=p<900?900:p;var kC=q<900?900:q;es=iL(-0.5*kb);ed=iL(1.5*kb);ez=hv(-0.5*kC);eC=hv(1.5*kC);}function lt(){if(c.mapStyle==aN){if(j&&j.parentNode==i){i.removeChild(j);}return;}var aX=new Array();var gy=eq.length-1;while(eq[gy]<c.zoomLevel&&gy>=0){gy--;}js(cF[gy],aX);mV(aX);}function js(eg,aX){if(nk(eg.boundingRectangle[0],eg.boundingRectangle[1])){return;}if(eg.childRegions!=null){for(var a=0;a<eg.childRegions.length;a++){js(eg.childRegions[a],aX);}}else{var cH=eg.indices;var eV=new Msn.VE.LatLong(dF[cH[0]],dr[cH[0]]);var eB;var fA=false;if(gt(eV.latitude,eV.longitude)){var fu=y.LatLongToPixel(eV,c.zoomLevel);aX.push(fu.x-K);aX.push(fu.y-M);fA=true;}for(var gS=1;gS<cH.length;gS++){eB=new Msn.VE.LatLong(dF[cH[gS]],dr[cH[gS]]);if(gt(eB.latitude,eB.longitude)){if(!fA){var fu=y.LatLongToPixel(eV,c.zoomLevel);aX.push(fu.x-K);aX.push(fu.y-M);}fA=true;var fv=y.LatLongToPixel(eB,c.zoomLevel);aX.push(fv.x-K);aX.push(fv.y-M);}else if(fA){fA=false;var fv=y.LatLongToPixel(eB,c.zoomLevel);aX.push(fv.x-K);aX.push(fv.y-M);}eV=eB;}}}function mV(aX){if(j&&j.parentNode==i){i.removeChild(j);}j=document.createElement("v:polyline");j.id=lp;j.className="Line";j.points=aX.join(" ");j.filled="false";j.style.zIndex=aT;j.unselectable="on";if(cG){j.style.display="block";}else{j.style.display="none";}var dZ=document.createElement("v:stroke");dZ.setAttribute("weight",kr);dZ.setAttribute("joinstyle","round");dZ.setAttribute("color",mb);dZ.setAttribute("endcap","round");var jL="0.75";if(c.mapStyle=='r'){jL="0.5";}dZ.setAttribute("opacity",jL);j.appendChild(dZ);i.appendChild(j);}function gt(cA,cO){return cA>=ed&&cA<=es&&cO>=ez&&cO<=eC;}function nk(gl,hi){return((gl.latitude>es&&hi.latitude>es)||(gl.latitude<ed&&hi.latitude<ed)||(gl.longitude>eC&&hi.longitude>eC)||(gl.longitude<ez&&hi.longitude<ez));}this.Init=pT;this.Destroy=bZ;this.RemoveFromMap=cK;this.Show=aO;this.Hide=as;this.ChangeVisibility=pm;this.StartLine=mk;this.UpdateLine=pS;}function nP(L){var bP=null;this.Init=function(){if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1){bP=document.createElement("div");bP.className="PoweredByLogo PoweredByLogo_ie";}else{bP=document.createElement("img");bP.src="i/logo_powered_by.png";bP.className="PoweredByLogo";}bA();L.appendChild(bP);};this.Destroy=function(){L.removeChild(bP);bP=null;};function bA(){bP.style.top=(p-40)+"px";bP.style.left="6px";bP.style.display="block";}function cl(){bA();}this.Reposition=bA;this.Update=cl;}function cR(b){b=ar(b);aG(b);if(bh){return false;}if(aQ){fh();}if(z){z.CancelRequest();}if(b.which&&b.which==2){cU=cP;}else if(!b.which&&b.button&&b.button==4){cU=cP;}else if(b.altKey){cU=cP;}cW=true;cU.OnMouseDown(b);return false;}function cL(b){b=ar(b);aG(b);if(cW){cU.OnMouseMove(b);}return false;}function bD(b){b=ar(b);aG(b);cW=false;cU.OnMouseUp(b);cU=dG;cb.focus();return false;}function mp(b){b=ar(b);aG(b);ku();if(aQ||bh){return false;}var e=at.MakeCopy();e.SetCenter(new Msn.VE.Pixel(K+ai+bl(b)-d,M+ah+ce(b)-f));if(b.altKey){e.SetZoomLevel(c.zoomLevel-1);}else{e.SetZoomLevel(c.zoomLevel+1);}au(e);return false;}function eo(b){b=ar(b);aG(b);if(aQ||bh){return false;}var co=jS(b);if(co>0){gL();}else if(co<0){fU();}return false;}function mo(b){b=ar(b);aG(b);var fE=K+ai+bl(b)-d;var fC=M+ah+ce(b)-f;var hl=fN(y.PixelToLatLong(new Msn.VE.Pixel(fE,fC),c.zoomLevel));ap("oncontextmenu",hl);return false;}function gP(br,bu){if(br==0&&bu==0){return;}lY(c,hP,br,bu);ai=c.center.x-K-q/2;ah=c.center.y-M-p/2;i.style.top=-ah+"px";i.style.left=-ai+"px";cq.Update();window.setTimeout(oH,1);window.setTimeout(op,2);}function gG(br,bu,eE,cb){if(bh){return;}if(!eE){eE=-1;}fS=br;fR=bu;gb=eE;if(!br&&!bu){fh();return;}iO=cb;if(!aQ){aQ=true;lj();ap("onstartcontinuouspan");}}function lj(){if(aQ){gP(fS,fR);if(gb>0)gb--;if(gb!=0)window.setTimeout(lj,10);else fh();}}function fh(){fS=0;fR=0;aQ=false;iO=false;if(eM!=null&&fL!=null){var o=new Msn.VE.LatLong(eM,fL);var l=y.LatLongToPixel(o,c.zoomLevel);var aE=l.x-(K+ai+q/2);var aH=l.y-(M+ah+p/2);gP(aE,aH);c.latlong.latitude=eM;c.latlong.longitude=fL;at.Copy(c);eM=null;fL=null;if(z){z.UpdateAvailability();}}else{lU(true);}ap("onendcontinuouspan");ap("onchangeview");}function jK(A,J){eM=A;fL=J;kB(y.LatLongToPixel(new Msn.VE.LatLong(A,J),c.zoomLevel));}function pu(e){kB(e.center);}function kB(l){if(c.mapStyle==aN){var g=z.GetScene();if(!g||!g.ContainsPixel(l,c.zoomLevel)){var e=at.MakeCopy();e.sceneId=null;e.SetCenterLatLong(z.PixelToLatLong(l,c.zoomLevel));au(e);return;}}var aE=l.x-(K+ai+q/2);var aH=l.y-(M+ah+p/2);var bg=Math.sqrt(aE*aE+aH*aH);if(!ej||aW(aE)>2*q||aW(aH)>2*p||bg>1.5*Math.sqrt(q*q+p*p)){var e=at.MakeCopy();e.SetCenter(l);au(e);return;}var dJ=Math.atan2(aH,aE);var eE=cw(bg/lD);var kd=aj(bg/eE);aE=aj(Math.cos(dJ)*kd);aH=aj(Math.sin(dJ)*kd);gG(aE,aH,eE);}function oJ(F,cA,cO,q,p,hJ,hw,aT){var E=new oN();E.Init(F,cA,cO,q,p,hJ,hw,aT);an.push(E);return E.pin;}function ng(F){for(var a=0;a<an.length;a++){var mG=an[a];if(mG.id==F){an.splice(a,1);mG.Destroy();return;}}}function pR(){while(an.length>0)an.pop().Destroy();}function oD(){for(var a=0;a<an.length;a++){an[a].Reposition();}}function oN(){var E=document.createElement("div");E.vePushpin=this;this.pin=E;var C=0,B=0,P=0,R=0;var bU=null;var aJ=0;var aI=0;var aL=ct+1;var bp=new Array(aL);var bb=new Array(aL);this.Init=function(F,cA,cO,q,p,hJ,hw,aT){this.id=F;E.id=F;E.className=hJ;E.style.position="absolute";E.style.zIndex=aT;E.innerHTML=hw;if(!V.fixedView){E.attachEvent("ondblclick",lJ);E.attachEvent("onmousewheel",eo);}E.unselectable="on";bU=new Msn.VE.LatLong(cA,cO);E.coords=bU;aJ=q;aI=p;var l=y.LatLongToPixel(bU,c.zoomLevel);if(l){C=aj(l.x-K);B=aj(l.y-M);P=C;R=B;cT();em(0);E.style.display="block";}else{E.style.display="none";}i.appendChild(E);};this.Destroy=function(){E.detachEvent("ondblclick",lJ);E.detachEvent("onmousewheel",eo);cK();E.vePushpin=null;E=null;this.pin=null;while(bp.length>0){bp.pop();}while(bb.length>0){bb.pop();}};this.GetLatitude=function(){return bU.latitude;};this.GetLongitude=function(){return bU.longitude;};function hc(){var aL=ct;for(var a=0;a<=aL;a++){bp[a]=C-aJ/2;bb[a]=B-aI/2;}}function cT(){var aL=ct;for(var a=0;a<=aL;a++){var af=a/aL;var W=1.0-af;bp[a]=ak(W*C+af*P-aJ/2)+"px";bb[a]=ak(W*B+af*R-aI/2)+"px";}}function em(a){E.style.left=(bp[a].toString().match(/px/) ? bp[a] : bp[a]+"px");E.style.top=(bb[a].toString().match(/px/) ? bb[a] : bb[a]+"px");}function gf(){var U=0;U=C;C=P;P=U;U=B;B=R;R=U;}function bA(){var l=y.LatLongToPixel(bU,c.zoomLevel);if(l){C=aj(l.x-K);B=aj(l.y-M);hc();em(0);E.style.display="block";}else{E.style.display="none";}}function nv(bF,bW,bo){C-=ai;B-=ah;var l=y.LatLongToPixel(bU,bo);if(l){P=aj(l.x-bF);R=aj(l.y-bW);cT();E.style.display="block";}else{E.style.display="none";}}function cK(){if(E.parentNode==i){i.removeChild(E);}}function lJ(b){b=ar(b);aG(b);if(aQ||bh){return false;}var e=at.MakeCopy();e.SetCenterLatLong(bU);if(b.altKey){e.SetZoomLevel(c.zoomLevel-1);}else{e.SetZoomLevel(c.zoomLevel+1);}au(e);return false;}function eo(b){b=ar(b);aG(b);if(aQ||bh){return false;}var co=jS(b);if(co>0){gL();}else if(co<0){fU();}return false;}this.ClearSteps=hc;this.PrecomputeSteps=cT;this.SetFactor=em;this.SwapStates=gf;this.Reposition=bA;this.PrepareForZoom=nv;this.RemoveFromMap=cK;}function qo(L){var cB=document.createElement("div");var cN=document.createElement("div");var cD=document.createElement("div");var dz=document.createElement("div");var ml=150;this.Init=function(){cB.className="ScaleBarLabel ScaleBarLabelBackground";cN.className="ScaleBarLabel ScaleBarLabelForeground";cD.className="ScaleBar ScaleBarBackground";dz.className="ScaleBar ScaleBarForeground";cl();bA();L.appendChild(cB);L.appendChild(cN);L.appendChild(cD);L.appendChild(dz);};this.Destroy=function(){L.removeChild(cB);L.removeChild(cN);L.removeChild(cD);L.removeChild(dz);cB=cN=cD=rS=null;};function bA(){cB.style.top=(p-45)+"px";cB.style.left=(q-160)+"px";cB.style.display="block";cN.style.top=(p-46)+"px";cN.style.left=(q-161)+"px";cN.style.display="block";cD.style.top=(p-30)+"px";cD.style.left=(q-160)+"px";cD.style.display="block";dz.style.top=(p-31)+"px";dz.style.left=(q-161)+"px";dz.style.display="block";}function rz(fc){return fc*0.001;}function oR(fc){return fc*0.000621371192;}function px(fc){return fc*1.0936133;}function cl(){try{var cs=mK();var kY=cs*ml;var gX="mi";var ge=oR(kY);var gN=mh(ge);if(gN<0.5){gX="yds";ge=px(kY);gN=mh(ge);}oW("us",gX,gN,Math.round(gN/ge*ml));}catch(dl){}}function mh(ln){var qi=Math.log(ln)/Math.log(10);var qj=Math.floor(qi);var hu=Math.pow(10,qj);var lo=ln/hu;var lq=Math.floor(lo);if(lq>=3.0){return lq*hu;}var oB=Math.floor(lo*2.0)*0.5;return oB*hu;}function oW(rC,gX,cX,q){if(cX<1){cX=cX.toFixed(1);}var kL=cX+" "+gX;cB.innerHTML=kL;cN.innerHTML=kL;cD.style.width=q;dz.style.width=q;}this.Update=cl;this.Reposition=bA;}var iV=0;var gB=0;var kM=0;var ex=new Array();ex[dd]=[325,975];ex[eW]=[350,1050];ex[dU]=[425,1275];ex[aN]=[450,1350];var bS=[0,0,0];function fP(d,f,bn,s){var U=new nI();U.Init(d,f,bn,s,(d*H-K),(f*H-M));return U;}function kI(kq){while(kq.length>0){var ad=kq.pop();ad.Destroy();ad=null;}}function pz(){var hr=0;for(var a=0;a<bS.length;a++){hr+=bS[a];}if(hr==0){return bS;}var lx=new Array(bS.length);for(var a=0;a<bS.length;a++){lx[a]=bS[a]/hr;}return lx;}function pN(){for(var a=0;a<bS.length;a++){bS[a]=0;}}function rp(){return kM/gB;}function nI(){var ax=null;var ay=null;var bs=document.createElement("div");var Z=0;var ab=0;var eS=0;var aa=0;var aT=0;var aL=ct+1;var bp=new Array(aL);var bb=new Array(aL);var ec=new Array(aL);var eb=new Array(aL);var iw=false;var C=0,B=0,cZ=0,di=0;var P=0,R=0,eI=0,dO=0;var iR=null;this.Init=function(qN,qQ,pO,ra,d,f){Z=qN;ab=qQ;eS=pO;aa=ra;bs.style.font="7pt Verdana, sans-serif";bs.style.color="Red";bs.style.backgroundColor="White";if(!y.IsValidTile(Z,ab,eS)){return;}hG(d,f,H,H);kK(d,f,H,H);cT();ay=new Image();ay.onload=ow;ay.onerror=Error;iR=new Date();ay.src=y.GetFilename(Z,ab,eS);};this.Destroy=function(){if(ax){ax.onmousedown=null;}cK();while(bp.length>0){bp.pop();}while(bb.length>0){bb.pop();}while(ec.length>0){ec.pop();}while(eb.length>0){eb.pop();}bp=bb=ec=eb=null;};function hG(d,f,aJ,aI){C=d;B=f;cZ=aJ;di=aI;}this.SetCurrentState=hG;function kK(d,f,aJ,aI){P=d;R=f;eI=aJ;dO=aI;}this.SetNextState=kK;function hc(){for(var a=0;a<=ct;a++){bp[a]=C+"px";bb[a]=B+"px";ec[a]=cZ+"px";eb[a]=di+"px";}}this.ClearSteps=hc;function cT(){for(var a=0;a<=ct;a++){var af=a/ct;var W=1.0-af;bp[a]=ak(W*C+af*P)+"px";bb[a]=ak(W*B+af*R)+"px";ec[a]=cw(W*cZ+af*eI)+"px";eb[a]=cw(W*di+af*dO)+"px";}}this.PrecomputeSteps=cT;function em(a){if(ax==null||(bh&&!iw)){return;}var db=ax.style;db.left=bp[a];db.top=bb[a];db.width=ec[a];db.height=eb[a];var hh=bs.style;if(fV&&a==0){db.border="1px dashed red";hh.left=bp[a];hh.top=bb[a];}if(ax.parentNode!=i){db.position="absolute";db.cursor="pointer";db.zIndex=aT;i.appendChild(ax);if(fV&&bs.parentNode!=i){var ck=ax.src;bs.innerHTML=ck.substring(ck.lastIndexOf("/")+1,ck.lastIndexOf("."));hh.position="absolute";hh.zIndex=(aT+1);i.appendChild(bs);}}}this.SetFactor=em;function gf(){var U=0;U=C;C=P;P=U;U=B;B=R;R=U;U=cZ;cZ=eI;eI=U;U=di;di=dO;dO=U;}this.SwapStates=gf;function cK(){if(ay){ay.onload=null;ay.onerror=null;ay=null;}if(ax){if(ax.parentNode==i){i.removeChild(ax);}ax=null;}if(bs){if(bs.parentNode==i){i.removeChild(bs);}bs=null;}}this.RemoveFromMap=cK;function ow(){if(eS!=c.zoomLevel||ay==null){return;}var ix=new Date();var eF=ix.getTime()-iR.getTime();mz(eF);iV+=eF;gB++;if(fV){window.status="last="+eF+", average="+(iV/gB);}ay.onload=null;ay.onerror=null;ax=ay;ax.onmousedown=function(b){return false;};ay=null;if(!bh){em(cS);}}function Error(){if(eS!=c.zoomLevel||ay==null){return;}var ix=new Date();var eF=ix.getTime()-iR.getTime();mz(eF);iV+=eF;gB++;kM++;ay.onload=null;ay.onerror=null;ay=null;}function mz(pl){for(var a=0;a<ex[aa].length;a++){if(pl<ex[aa][a]){bS[a]++;return;}}bS[bS.length-1]++;}function oG(dh,dg,dE,bF,bW,bo){hG(C-ai,B-ah,cZ,di);var hs=bo-dE;var T=Math.pow(2,hs);P=ak((dh+C)*T-bF);R=ak((dg+B)*T-bW);eI=cw((dh+C+cZ)*T-bF)-P;dO=cw((dg+B+di)*T-bW)-R;iw=true;cT();aT=gw;if(ax!=null){ax.style.zIndex=aT;}}this.PrepareBaseTile=oG;function oc(dh,dg,dE,bF,bW,bo){var hs=dE-bo;var T=Math.pow(2,hs);P=ak((bF+C)*T-dh);R=ak((bW+B)*T-dg);eI=cw((bF+C+cZ)*T-dh)-P;dO=cw((bW+B+di)*T-dg)-R;var lc=cw(aK*0.25);var lH=cw(cf*0.25);iw=bo<dE&&(Z<bY+lc||Z>cj-lc||ab<bN+lH||ab>cm-lH);gf();cT();aT=ld;}this.PrepareSwapTile=oc;function iy(aM){if(ax!=null){ax.style.border=aM?"1px dashed red":"0px";}bs.style.display=aM?"block":"none";}this.Debug=iy;}function lN(){kI(I);i.style.top="0px";i.style.left="0px";K=aj(c.center.x-q/2);M=aj(c.center.y-p/2);ai=0;ah=0;bY=ak((K-bM)/H);bN=ak((M-bM)/H);cj=ak((K+q+bM)/H);cm=ak((M+p+bM)/H);aK=cj-bY+1;cf=cm-bN+1;for(var f=bN;f<=cm;f++){for(var d=bY;d<=cj;d++){var ad=fP(d,f,c.zoomLevel,c.mapStyle);I.push(ad);}}}function oH(){if(bh){return;}var kW=K+ai;var kR=M+ah;var C=ak((kW-bM)/H);var B=ak((kR-bM)/H);var P=ak((kW+q+bM)/H);var R=ak((kR+p+bM)/H);while(bY<C){for(var f=cf-1;f>=0;f--){var ad=I.splice(f*aK,1)[0];ad.RemoveFromMap();}bY++;aK--;}while(bY>C){bY--;aK++;for(var f=0;f<cf;f++){var ad=fP(bY,bN+f,c.zoomLevel,c.mapStyle);I.splice(f*aK,0,ad);}}while(bN<B){for(var d=0;d<aK;d++){var ad=I.shift();ad.RemoveFromMap();}bN++;cf--;}while(bN>B){bN--;cf++;for(var d=aK-1;d>=0;d--){var ad=fP(bY+d,bN,c.zoomLevel,c.mapStyle);I.unshift(ad);}}while(cj>P){for(var f=cf-1;f>=0;f--){var ad=I.splice(f*aK+aK-1,1)[0];ad.RemoveFromMap();}cj--;aK--;}while(cj<P){cj++;aK++;for(var f=0;f<cf;f++){var ad=fP(cj,bN+f,c.zoomLevel,c.mapStyle);I.splice(f*aK+aK-1,0,ad);}}while(cm>R){for(var d=0;d<aK;d++){var ad=I.pop();ad.RemoveFromMap();}cm--;cf--;}while(cm<R){cm++;cf++;for(var d=0;d<aK;d++){var ad=fP(bY+d,cm,c.zoomLevel,c.mapStyle);I.push(ad);}}}function au(v){if(bh||aQ||cW){return;}var ek=v.latlong;if(v.GetViewType()=="latlongRect"){ek=v.latlongRect.Center();}if(v.mapStyle==aN){if(z==null){return;}at.Copy(v);y=z;x.style.backgroundColor="black";v.Resolve(y,q,p);var g=z.GetScene();if((!g||g.GetID()!=v.sceneId)&&v.sceneId!=null){z.RequestScene(v.sceneId);return;}if(!g||(!g.ContainsLatLong(ek,v.zoomLevel)&&g.GetID()!=v.sceneId)||g.GetOrientation()!=v.sceneOrientation){z.RequestSceneAtLatLong(ek,v.sceneOrientation,true);return;}}else{y=dn;if(v.mapStyle=='r'){x.style.backgroundColor="#e9e7d4";}else{x.style.backgroundColor="black";}v.Resolve(y,q,p);}ek=v.latlong;at.Copy(v);y.ValidateZoomLevel(v);hP=y.GetBounds(v);na(v,hP);v.Resolve(y,q,p);if(v.Equals(c)){return;}var br=v.GetX(c.zoomLevel)-c.center.x;var bu=v.GetY(c.zoomLevel)-c.center.y;var bg=Math.sqrt(br*br+bu*bu);var rw=(bg<q&&bg<p)&&(v.zoomLevel==c.zoomLevel)&&ej&&(v.mapStyle==c.mapStyle)&&(v.sceneId==null||v.sceneId==c.sceneId);if(rw){jK(ek.latitude,ek.longitude);return;}kz=c.zoomLevel;if(c.zoomLevel!=v.zoomLevel){ap("onstartzoom");bh=true;}var qq=(bg<q&&bg<p)&&(v.zoomLevel==c.zoomLevel-1||v.zoomLevel==c.zoomLevel+1)&&ej&&(v.mapStyle==c.mapStyle)&&(v.sceneId==null||v.sceneId==c.sceneId);if(qq){var dh=K+ai;var dg=M+ah;var dE=c.zoomLevel;var bo=v.zoomLevel;var bF=aj(v.center.x-q/2);var bW=aj(v.center.y-p/2);cE=I;I=new Array();for(var a=0;a<cE.length;a++){cE[a].PrepareBaseTile(dh,dg,dE,bF,bW,bo);}for(var a=0;a<an.length;a++){an[a].PrepareForZoom(bF,bW,bo);}kc();c.Destroy();c=v;lN();for(var a=0;a<I.length;a++){I[a].PrepareSwapTile(dh,dg,dE,bF,bW,bo);}cS=1;mm();return;}cE=I;I=new Array();c.Destroy();c=v;kc();lN();lz();oD();}function mm(){if(!bh){return;}for(var a=0;a<cE.length;a++){cE[a].SetFactor(cS);}for(var a=0;a<I.length;a++){I[a].SetFactor(cS);}for(var a=0;a<an.length;a++){an[a].SetFactor(cS);}if(cS<ct){cS++;window.setTimeout(mm,1);}else{cS=0;lz();}}function lz(){kI(cE);cE=null;bh=false;for(var a=0;a<I.length;a++){I[a].SwapStates();I[a].ClearSteps();I[a].SetFactor(0);}for(var a=0;a<an.length;a++){an[a].SwapStates();an[a].ClearSteps();an[a].SetFactor(0);}rJ=null;rK=null;window.setTimeout(pV,250);if(cq){cq.Update();}if(rf!=c.mapStyle){ap("onchangemapstyle");}if(kz!=c.zoomLevel){ap("onendzoom");}ap("onchangeview");if(z){window.setTimeout(z.UpdateAvailability,100);}try{CollectGarbage();}catch(dl){}}function mt(qs,pK,ql,pJ){var e=at.MakeCopy();e.sceneId=null;e.SetLatLongRectangle(new Msn.VE.LatLongRectangle(new Msn.VE.LatLong(qs,pK),new Msn.VE.LatLong(ql,pJ)));au(e);}function kt(ci){if(!ci||ci.constructor!=Array){return;}var af=ci[0].latitude;var W=ci[0].longitude;var k=af;var aM=W;for(var a=1;a<ci.length;a++){af=dR(af,ci[a].latitude);W=dR(W,ci[a].longitude);k=dV(k,ci[a].latitude);aM=dV(aM,ci[a].longitude);}var kQ=(k-af)*0.1;var mH=(aM-W)*0.1;af-=kQ;W-=mH;k+=kQ;aM+=mH;mt(ky(af),lX(W),ky(k),lX(aM));}function pQ(A,J){var o=new Msn.VE.LatLong(A,J);if(c.mapStyle==aN){var g=z.GetScene();if(!g||!g.ContainsLatLong(o)){cg(hW);}}kt(new Array(c.latlong,o));}function ky(A){return mx(A,jI,mT);}function lX(J){return mx(J,lT,lf);}function mx(aL,lh,lR){if(aL<lh){return lh;}if(aL>lR){return lR;}return aL;}function rd(){var d=null;try{d=new ActiveXObject("Msxml2.XMLHTTP");}catch(dl){try{d=new ActiveXObject("Microsoft.XMLHTTP");}catch(dl){d=null;}}if(!d&&typeof XMLHttpRequest!="undefined"){d=new XMLHttpRequest();}return d;}function ri(m){var e=at.MakeCopy();e.SetZoomLevel(m);au(e);}function gL(){var e=at.MakeCopy();e.SetZoomLevel(c.zoomLevel+1);au(e);}function fU(){var e=at.MakeCopy();e.SetZoomLevel(c.zoomLevel-1);au(e);}function pf(A,J,m){var e=at.MakeCopy();e.sceneId=null;e.SetCenterLatLong(new Msn.VE.LatLong(A,J));e.SetZoomLevel(m);au(e);}function rr(){var g=null;var bk=false;var hm=false;var bq=null;var hy=null;var gp=false;var fz=null;var dP=-1;var t=['02121222233','02121222322','02121222323','02121222332','02121222333','02121223222','02121223223','02121223232','02123000101','02123000103','02123000110','02123000111','02123000112','02123000113','02123000130','02123000131','02123001000','02123001001','02123001002','02123001003','02123001010','02123001012','02123001020','02123001021','02123001030','02123002113','02123002131','02123002133','02123002311','02123002313','02123003002','02123003003','02123003012','02123003020','02123003021','02123003022','02123003023','02123003030','02123003032','02123003200','02123003201','02123003202','02123003210','02133301103','02133301112','02133301113','02133301120','02133301121','02133301122','02133301123','02133301130','02133301131','02133301132','02133301133','02133301300','02133301301','02133301303','02133301310','02133301311','02133301312','02133310020','02133310022','02133310200','02133310222','02133310223','02133310232','02133310233','02133310322','02133312000','02133312001','02133312002','02133312003','02133312010','02133312011','02133312012','02133312013','02133312021','02133312030','02133312031','02133312100','02133312102','02133333112','02133333121','02133333122','02133333123','02133333130','02133333131','02133333132','02133333133','02133333201','02133333203','02133333210','02133333211','02133333212','02133333213','02133333300','02133333301','02133333302','02133333303','02133333310','02301020311','02301020313','02301020331','02301020332','02301020333','02301021013','02301021021','02301021022','02301021023','02301021030','02301021031','02301021032','02301021033','02301021122','02301021200','02301021201','02301021202','02301021203','02301021210','02301021211','02301021212','02301021213','02301021222','02301021300','02301022110','02301022111','02301031102','02301031103','02301031120','02301031121','02301031131','02301031133','02301120020','02301120022','02301213211','02301213213','02301213300','02301213301','02301213302','02301213303','02301213310','02301213311','02301213312','02301213313','02301213320','02301213321','02301213322','02301213323','02301213330','02301213331','02301213332','02301213333','02301231013','02301231031','02301231100','02301231101','02301231102','02301231103','02301231110','02301231111','02301231112','02301231113','02301231120','02301231121','02301231130','02301231131','02301231132','02301231133','02301231310','02301231311','02301300230','02301300231','02301300232','02301300233','02301300302','02301300320','02301301131','02301301133','02301301332','02301301333','02301302123','02301302132','02301302133','02301302200','02301302201','02301302202','02301302203','02301302210','02301302211','02301302212','02301302213','02301302220','02301302221','02301302222','02301302223','02301302230','02301302231','02301302232','02301302233','02301302300','02301302301','02301302302','02301302303','02301302310','02301302311','02301302312','02301302313','02301302320','02301302321','02301302322','02301302323','02301302330','02301302331','02301302332','02301302333','02301303021','02301303022','02301303110','02301303111','02301303200','02301303201','02301310020','02301310021','02301310022','02301310023','02301310200','02301310201','02301312033','02301312211','02301312300','02301312302','02301312320','02301312321','02301312332','02301320000','02301320001','02301320002','02301320003','02301320010','02301320011','02301320012','02301320013','02301320020','02301320021','02301320022','02301320023','02301320030','02301320031','02301320032','02301320033','02301320100','02301320101','02301320102','02301320103','02301320110','02301320111','02301320112','02301320113','02301320120','02301320121','02301320130','02301320200','02301320201','02301320203','02301320210','02301320211','02301320212','02301320213','02301320230','02301320231','02301320300','02301321001','02301321002','02301321003','02301321010','02301321011','02301321012','02301321013','02301321100','02301321101','02301321102','02301321103','02301330011','02301330100','02301330101','02301330102','02301330103','02301330110','02310101223','02310101230','02310101232','02310101233','02310103001','02310103010','02310103023','02310103030','02310103031','02310103032','02310103033','02310103120','02310103122','02310103203','02310103210','02310103211','02310103212','02310103213','02310103300','02310103302','02310210322','02310210323','02310210332','02310210333','02310211203','02310211212','02310211213','02310211221','02310211222','02310211223','02310211230','02310211231','02310211232','02310211233','02310211302','02310211303','02310211320','02310211321','02310211322','02310212011','02310212100','02310212101','02310212110','02310212111','02310212112','02310212130','02310212132','02310213000','02310213001','02310213002','02310213003','02310213010','02310213011','02310213012','02310213100','02310213112','02310213113','02310213130','02310213131','02310213132','02310213133','02310213311','02310223202','02310223203','02310223220','02310223221','02310302002','02310302003','02310302012','02310302013','02310302020','02310302021','02310302022','02310302023','02310302030','02310302031','02310302032','02310302033','02310302120','02310302121','02310302122','02310302123','02310302200','02310302201','02310302210','02310302211','02310302212','02310302213','02310302230','02310302231','02310302232','02310302233','02310302300','02310302301','02310302302','02310302320','02311030103','02311030112','02311030113','02311030121','02311030123','02311030130','02311030131','02311030132','02311030133','02311030310','02311030311','02311030313','02311031002','02311031003','02311031020','02311031021','02311031022','02311031023','02311031200','02311031201','02311031202','02311031203','02311102213','02311102231','02311102302','02311102303','02311102320','02311102321','02311102323','02311102332','02311102333','02311103222','02311120101','02311120103','02311120110','02311120111','02311120112','02311120113','02311120121','02311120130','02311120131','02311121000','02311121002','02311121020','02311231220','02311231221','02311231222','02311231223','02311231230','02311231231','02311231232','02311231233','02311231320','02311231322','02311232023','02311232032','02311232033','02311232100','02311232101','02311232102','02311232103','02311232110','02311232111','02311232112','02311232113','02311232120','02311232121','02311232122','02311232123','02311232130','02311232131','02311232132','02311232133','02311232201','02311232210','02311232211','02311232212','02311232213','02311232230','02311232231','02311232300','02311232301','02311232302','02311232310','02311232311','02311233000','02311233001','02311233002','02311233003','02311233010','02311233011','02311233012','02311233013','02311233020','02311233021','02311233022','02311233100','02311233102','02311233200','02311300101','02311300103','02311300110','02311300111','02311300112','02311300113','02311300121','02311300123','02311300130','02311300131','02311300132','02311300133','02311300310','02311300311','02311300312','02311300313','02311300331','02311301000','02311301001','02311301002','02311301003','02311301010','02311301012','02311301020','02311301021','02311301022','02311301023','02311301030','02311301200','02311301201','02311301202','02311301203','02311323131','02311323133','02311323311','02311332020','02311332021','02311332022','02311332023','02311332032','02311332200','02311332201','02311332210','02313032013','02313032030','02313032031','02313032032','02313032033','02313032120','02313032121','02313032122','02313032123','02313032130','02313032131','02313032132','02313032133','02313032210','02313032211','02313032300','02313032301','02313032310','02313032311','02313102232','02313102233','02313102332','02313102333','02313113033','02313113122','02313113210','02313113211','02313113212','02313113213','02313113230','02313113231','02313113233','02313113300','02313113302','02313113303','02313113311','02313113313','02313113320','02313113321','02313113322','02313113323','02313113330','02313113331','02313113332','02313113333','02313120010','02313120011','02313120012','02313120013','02313120030','02313120031','02313120032','02313120100','02313120101','02313120102','02313120103','02313120110','02313120120','02313131101','02313131103','02313131110','02313131111','02313131112','02313131113','02313131121','02313131130','02313131131','02313131132','02313131133','02313210211','02313210213','02313210231','02313210300','02313210301','02313210302','02313210303','02313210310','02313210311','02313210312','02313210313','02313210320','02313210321','02313210322','02313210323','02313210330','02313210331','02313210332','02313210333','03022220013','03022220031','03022220033','03022220102','03022220103','03022220112','03022220113','03022220120','03022220121','03022220122','03022220123','03022220130','03022220131','03022220132','03022220133','03022220211','03022220300','03022220301','03022220310','03022220311','03022313313','03022313330','03022313331','03022313332','03022313333','03022320313','03022322030','03022322031','03022322032','03022322033','03022322120','03022322121','03022322122','03022322123','03022322130','03022322132','03022322210','03022322211','03022323021','03022323022','03022323023','03022323123','03022323200','03022323201','03022323202','03022323203','03022323210','03022323211','03022323212','03022323213','03022323231','03022323233','03022323300','03022323301','03022323302','03022323303','03022323312','03022323320','03022323321','03022323322','03022330332','03022330333','03022331110','03022331111','03022331113','03022331123','03022331130','03022331131','03022331132','03022331133','03022331220','03022331221','03022331222','03022331223','03022331230','03022331232','03022331301','03022331310','03022331311','03022332003','03022332012','03022332013','03022332020','03022332021','03022332022','03022332023','03022332030','03022332031','03022332032','03022332033','03022332101','03022332103','03022332110','03022332111','03022332112','03022332113','03022332200','03022332201','03022332202','03022332203','03022332210','03022332211','03022332212','03022332213','03022332231','03022332232','03022332233','03022332320','03022332321','03022332322','03022332323','03022333000','03022333001','03022333002','03022333003','03022333010','03022333011','03022333012','03022333013','03023202202','03023202203','03023202212','03023202213','03023202220','03023202221','03023202222','03023202223','03023202230','03023202231','03023202232','03023202233','03023202302','03023202303','03023202320','03023202321','03023202322','03023202323','03023202330','03023202331','03023202332','03023202333','03023203213','03023203231','03023203233','03023203302','03023203320','03023203321','03023203322','03023203323','03023203330','03023203331','03023203332','03023203333','03023212222','03023212233','03023220000','03023220001','03023220002','03023220003','03023220010','03023220011','03023220012','03023220013','03023220020','03023220021','03023220022','03023220023','03023220030','03023220031','03023220032','03023220033','03023220100','03023220101','03023220102','03023220103','03023220110','03023220111','03023220112','03023220113','03023220120','03023220122','03023220130','03023220131','03023220132','03023220133','03023220200','03023220201','03023220210','03023220211','03023220212','03023220213','03023220230','03023220231','03023220232','03023220233','03023220300','03023220301','03023220302','03023220303','03023220310','03023220311','03023220312','03023220313','03023220320','03023220321','03023220322','03023220323','03023220330','03023220331','03023220332','03023220333','03023221000','03023221001','03023221002','03023221003','03023221010','03023221011','03023221012','03023221013','03023221020','03023221021','03023221022','03023221023','03023221030','03023221031','03023221032','03023221033','03023221100','03023221101','03023221102','03023221103','03023221110','03023221111','03023221112','03023221113','03023221120','03023221121','03023221122','03023221123','03023221130','03023221131','03023221132','03023221200','03023221201','03023221202','03023221203','03023221210','03023221211','03023221220','03023221221','03023221222','03023221223','03023221230','03023221232','03023221300','03023221303','03023221312','03023221313','03023221320','03023221321','03023221322','03023221323','03023221330','03023221331','03023221332','03023221333','03023222010','03023222011','03023222100','03023222101','03023222110','03023222111','03023223000','03023223001','03023223010','03023223100','03023223101','03023223110','03023223111','03023230000','03023230002','03023230020','03023231130','03023231131','03023231132','03023231133','03023231310','03023231311','03023231312','03023231313','03023231321','03023231323','03023231330','03023231331','03023231332','03023231333','03023233101','03023233110','03023233111','03023233212','03023233213','03023233221','03023233223','03023233230','03023233231','03023233232','03023233233','03023320020','03023320021','03023320022','03023320023','03023320030','03023320031','03023320032','03023320033','03023320120','03023320121','03023320122','03023320123','03023320130','03023320131','03023320132','03023320133','03023320200','03023320201','03023320202','03023320203','03023320210','03023320211','03023320212','03023320213','03023320220','03023320221','03023320222','03023320223','03023320230','03023320231','03023320232','03023320233','03023320300','03023320301','03023320302','03023320303','03023320310','03023320311','03023320312','03023320313','03023320320','03023320321','03023320322','03023320323','03023320330','03023320331','03023320332','03023320333','03023321003','03023321013','03023321020','03023321021','03023321022','03023321023','03023321030','03023321031','03023321032','03023321033','03023321102','03023321103','03023321120','03023321121','03023321122','03023321123','03023321130','03023321132','03023321200','03023321201','03023321202','03023321203','03023321210','03023321211','03023321212','03023321213','03023321220','03023321221','03023321222','03023321223','03023321230','03023321231','03023321232','03023321233','03023321300','03023321301','03023321302','03023321320','03023321321','03023321322','03023321323','03023321332','03023322000','03023322001','03023322010','03023322011','03023322100','03023322101','03023322110','03023322111','03023323000','03023323001','03023323002','03023323003','03023323010','03023323011','03023323012','03023323013','03023323020','03023323021','03023323023','03023323030','03023323031','03023323032','03023323033','03023323100','03023323101','03023323102','03023323103','03023323110','03023323112','03023323113','03023323120','03023323121','03023323122','03023323123','03023323130','03023323131','03023323132','03023323133','03023323201','03023323210','03023323211','03023323300','03023323301','03023323302','03023323303','03023323310','03023323311','03023323312','03023323313','03023330222','03023330223','03023332000','03023332001','03023332002','03023332003','03023332010','03023332012','03023332020','03023332021','03023332022','03023332023','03023332030','03023332032','03023332201','03023332202','03023332203','03023332212','03023332220','03023332221','03131013130','03131013131','03131013132','03131013133','03131102020','03131102022','03131133020','03131133021','03131133022','03131133023','03131133030','03131133032','03131133200','03131133201','03131133210','03131310323','03131310332','03131311113','03131311131','03131311303','03131311312','03131311321','03131311323','03131311330','03131311332','03131312000','03131312001','03131312002','03131312003','03131312010','03131312012','03131312020','03131312021','03131312030','03131312101','03131312103','03131312110','03131312112','03131312312','03131312313','03131312330','03131312331','03131312332','03131312333','03131313111','03131313113','03131313130','03131313131','03131313202','03131313203','03131313212','03131313220','03131313221','03131313222','03131313223','03131313230','03131313232','03131313321','03131313322','03131313323','03131313330','03131313331','03131313332','03131313333','03200000320','03200000321','03200000322','03200000323','03200000330','03200000331','03200000332','03200000333','03200002100','03200002101','03200002102','03200002103','03200002110','03200002111','03200002112','03200002113','03200002120','03200002121','03200002130','03200010303','03200010312','03200010313','03200010321','03200010322','03200010323','03200010330','03200010331','03200010332','03200010333','03200011233','03200011322','03200011323','03200012100','03200012101','03200012102','03200012103','03200012110','03200012111','03200012112','03200012113','03200012120','03200012121','03200012130','03200012131','03200013011','03200013013','03200013100','03200013101','03200013102','03200013103','03200013131','03200013301','03200013303','03200013310','03200013311','03200013312','03200013313','03200013330','03200013331','03200023130','03200023131','03200023132','03200023133','03200023311','03200031310','03200031311','03200031312','03200031313','03200031330','03200031331','03200031333','03200032020','03200032021','03200032022','03200032023','03200032200','03200032201','03200100311','03200100312','03200100313','03200100322','03200100323','03200100330','03200100331','03200100332','03200101202','03200101220','03200102020','03200102021','03200102022','03200102023','03200102030','03200102032','03200102100','03200102101','03200102102','03200102103','03200102110','03200102112','03200102200','03200102201','03200102202','03200102210','03200102220','03200110010','03200110011','03200110100','03200110101','03200120122','03200120123','03200120132','03200120200','03200120202','03200120220','03200120222','03200120300','03200120301','03200120302','03200120303','03200120310','03200120312','03200203001','03200203003','03200203010','03200203011','03200203012','03200203013','03200203021','03200203023','03200203030','03200203031','03200203032','03200203033','03200210033','03200210122','03200210211','03200210212','03200210213','03200210230','03200210231','03200210300','03200210301','03200210302','03200210303','03200210310','03200210320','03200210321','03200213032','03200213033','03200213103','03200213112','03200213113','03200213121','03200213122','03200213123','03200213130','03200213131','03200213132','03200213133','03200213210','03200213211','03200213300','03200230101','03200230102','03200230103','03200230110','03200230111','03200230112','03200230113','03200230120','03200230121','03200230130','03200230131','03200230132','03200231002','03200231020','03200231103','03200231112','03200231113','03200231121','03200231123','03200231130','03200231131','03200231132','03200231133','03200231301','03200231303','03200231310','03200231311','03200231312','03200231313','03200232120','03200232121','03200232122','03200232123','03200232130','03200232131','03200232132','03200232133','03200232300','03200232301','03200232310','03200232311','03200232312','03200302002','03200302020','03200302022','03200302222','03200302223','03200302232','03200320000','03200320001','03200320002','03200320003','03200320010','03200320012','03200320013','03200320020','03200320021','03200320022','03200320023','03200320030','03200320031','03200320032','03200320200','03200320201','03200320210','03200332203','03200332212','03200332220','03200332221','03200332222','03200332223','03200332230','03200332231','03200332232','03200332233','03200332322','03201000333','03201001212','03201001213','03201001220','03201001221','03201001222','03201001223','03201001230','03201001231','03201001232','03201001233','03201001320','03201001322','03201001323','03201002111','03201002113','03201002311','03201002312','03201002313','03201002331','03201002332','03201002333','03201003000','03201003001','03201003002','03201003003','03201003010','03201003011','03201003012','03201003013','03201003033','03201003100','03201003101','03201003102','03201003103','03201003110','03201003112','03201003122','03201003200','03201003201','03201003202','03201003203','03201003211','03201003212','03201003220','03201003221','03201003222','03201003223','03201003230','03201003231','03201003232','03201003233','03201003300','03201003302','03201010032','03201010201','03201010203','03201010210','03201010211','03201010212','03201010213','03201010221','03201010230','03201010231','03201010232','03201010233','03201010300','03201010301','03201010302','03201010303','03201010310','03201010311','03201010312','03201010313','03201010320','03201010321','03201010322','03201010323','03201010330','03201010331','03201011001','03201011002','03201011003','03201011010','03201011011','03201011012','03201011013','03201011020','03201011021','03201011023','03201011030','03201011031','03201011032','03201011033','03201011100','03201011101','03201011102','03201011103','03201011110','03201011112','03201011120','03201011121','03201011122','03201011123','03201011130','03201011202','03201012011','03201012100','03201012101','03201012112','03201012113','03201012121','03201012123','03201012130','03201012131','03201012132','03201012133','03201012301','03201012303','03201012310','03201012311','03201012312','03201012313','03201012321','03201012323','03201012330','03201012332','03201013020','03201013022','03201013023','03201013200','03201020111','03201020132','03201020133','03201021000','03201021001','03201021002','03201021003','03201021010','03201021011','03201021012','03201021013','03201021031','03201022110','03201022111','03201022112','03201022113','03201022130','03201022131','03201023303','03201023312','03201023313','03201023320','03201023321','03201023322','03201023323','03201023330','03201023331','03201023332','03201023333','03201032220','03201032222','03201201100','03201201101','03201201110','03201201111','03201210000','03202002022','03202002023','03202002032','03202002200','03202002201','03202002202','03202002210','03202010333','03202011222','03202011223','03202011232','03202012111','03202012113','03202012130','03202012131','03202013000','03202013001','03202013002','03202013003','03202013010','03202013012','03202013020','03202013021','03202101311','03202101313','03202101323','03202101332','03202101333','03202102331','03202102333','03202103101','03202103103','03202103110','03202103111','03202103112','03202103113','03202103121','03202103123','03202103130','03202103131','03202103132','03202103133','03202103202','03202103203','03202103220','03202103221','03202103222','03202103223','03202103311','03202110001','03202110003','03202110010','03202110011','03202110012','03202110013','03202110100','03202110200','03202110201','03202110202','03202110203','03202110220','03202112000','03202112002','03202112020','03202112021','03202112022','03202112023','03202112200','03202121023','03202121032','03202121033','03202121201','03202121203','03202121210','03202121211','03202121212','03202121213','03202121300','03202121302','03202121311','03202121313','03202121323','03202121331','03202121332','03202121333','03202123100','03202123101','03202123103','03202123110','03202123111','03202123112','03202123113','03202123121','03202123123','03202123130','03202123131','03202123132','03202123133','03202123301','03202123310','03202123311','03202130200','03202130201','03202130202','03202130203','03202130210','03202130212','03202130220','03202130221','03202130222','03202130223','03202130230','03202130231','03202130232','03202130233','03202132000','03202132002','03202132003','03202132020','03202132021','03202132022','03202132023','03202132032','03202132200','03202132201','03202132210','03202301011','03202301013','03202301031','03202301100','03202301102','03202301103','03202301112','03202301113','03202301120','03202301121','03202301122','03202301123','03202301130','03202301131','03202301132','03202301133','03202301300','03202301301','03202301310','03202301311','03202310020','03202310022','03202310200','12020200002','12020200003','12020200020','12020200021','12020200022','12020200023','12020202000','12020202001','12020202002','12020202003','12020202020','12020202021','12020202311'];this.Init=function(or){hy=or;};this.Destroy=function(){};function ft(Z,ab,m){return g.IsValidTile(Z,ab,m);}function hQ(Z,ab,ch){return g.GetTileFilename(Z,ab,ch);}function cd(m){if(!g){return 0;}var l=new Msn.VE.Pixel(aj(K+ai+q/2),aj(M+ah+p/2));var jG=g.PixelToLatLong(l,m);l.x++;var jo=g.PixelToLatLong(l,m);var eX=Math.sin(cp(jG.latitude));var eU=Math.sin(cp(jo.latitude));var md=bf/2*aW(Math.log((1+eX)/(1-eX))-Math.log((1+eU)/(1-eU)));var mN=bf*aW(cp(jG.longitude)-cp(jo.longitude));return Math.sqrt(mN*mN+md*md);}function dj(l,m){return g?g.PixelToLatLong(l,m):null;}function cM(o,m){return g?g.LatLongToPixel(o,m):null;}function gg(e){if(e.zoomLevel<1){e.SetZoomLevel(1);}else if(e.zoomLevel>2){e.SetZoomLevel(2);}}function os(){return g;}function du(){return g.GetBounds();}function rn(){return bk;}function pF(){if(!bk){return null;}var oU=new Object();return oU;}function nw(){if(c.mapStyle==aN){return;}if(c.zoomLevel<12){g=null;hm=bk;bk=false;hC();return;}jz(c.latlong,"North",false,500);}function jz(o,eH,qC,kh){gq();gp=qC;if(!mX(o)){g=null;hm=bk;bk=false;hC();return;}fz=hy+"?lat="+o.latitude+"&lon="+o.longitude;if(eH){fz+="&o="+eH;}if(kh){dP=window.setTimeout(jg,kh);}else{jg();dP=-1;}}function pn(F){if(g&&g.GetID()==F){return;}gq();gp=true;fz=hy+"?id="+F;jg();}function gq(){try{if(dP!=-1){window.clearTimeout(dP);}}catch(dl){}dP=-1;try{if(bq){bq.onreadystatechange=null;bq.abort();}}catch(dl){}}function jg(){gq();if(!fz){return;}if(!bq){bq=rd();}if(bq){bq.open("POST",fz,true);bq.onreadystatechange=nf;bq.send("");}}function nf(){if(!bq||bq.readyState!=4){return;}dP=-1;hm=bk;var lE=bq.responseText;if(lE){try{g=eval(lE);bk=true;}catch(dl){g=null;bk=false;}}else{g=null;bk=false;}hC();}function hC(){if(gp){gp=false;if(bk){var e=at.MakeCopy();e.SetMapStyle(aN,g.GetID(),g.GetOrientation());au(e);ap("onobliquechange");}else{var e=at.MakeCopy();e.SetMapStyle(hW);if(e.GetViewType()!="latlongRect"){e.SetZoomLevel(hB);}au(e);ap("onerror",fN(c.latlong,c.zoomLevel,"Bird's Eye images are not available for this area."));}}if(hm!=bk){if(bk){ap("onobliqueenter");}else{ap("onobliqueleave");}}}function mX(o){if(!o||!t||t.length==0){return false;}var bK=qY(o,t[0].length);return ip(bK,0,t.length-1);}function qY(o,m){var l=dn.LatLongToPixel(o,m);var Z=ak(l.x/H);var ab=ak(l.y/H);var bK="";for(var a=m;a>0;a--){var al=0;var eY=1<<(a-1);if((Z&eY)!=0){al++;}if((ab&eY)!=0){al+=2;}bK+=(al+"");}return bK;}function ip(bK,bC,bB){if(bB<bC)return false;var gM=ak((bC+bB)/2);if(t[gM]==bK)return true;if(bK<t[gM])return ip(bK,bC,gM-1);return ip(bK,gM+1,bB);}this.IsValidTile=ft;this.GetFilename=hQ;this.MetersPerPixel=cd;this.PixelToLatLong=dj;this.LatLongToPixel=cM;this.GetBounds=du;this.ValidateZoomLevel=gg;this.IsAvailable=rn;this.UpdateAvailability=nw;this.CancelRequest=gq;this.GetEventInfo=pF;this.GetScene=os;this.RequestSceneAtLatLong=jz;this.RequestScene=pn;}function oI(){var t=[new Msn.VE.Bounds(1, 17, 0, 0, 2, 2),new Msn.VE.Bounds(18, 19, 35680, 82915, 83740, 113061),new Msn.VE.Bounds(18, 19, 123062, 74647, 132528, 89130),new Msn.VE.Bounds(18, 19, 12379, 112260, 20388, 119266),new Msn.VE.Bounds(18, 19, 80099, 115425, 85051, 119645)];this.Init=function(){};this.Destroy=function(){};function ft(Z,ab,m){var aA=1<<m;return Z>=0&&ab>=0&&Z<aA&&ab<aA;}function hQ(Z,ab,ch){var mC="";var al=0;for(var a=ch;a>0;a--){al=0;var eY=1<<(a-1);if((Z&eY)!=0){al++;}if((ab&eY)!=0){al+=2;}mC+=al+"";}return"http://"+c.mapStyle+al+".ortho.tiles.virtualearth.net/tiles/"+c.mapStyle+mC+(c.mapStyle==dd?".png":".jpeg")+"?g="+dT[c.mapStyle];}function cd(m){return gc/((1<<m)*H);}function dj(l,m){var fd=cd(m);var ia=l.x*fd-fJ;var hT=fJ-l.y*fd;var o=new Msn.VE.LatLong();o.latitude=ho(Math.PI/2-2*Math.atan(Math.exp(-hT/bf)));o.longitude=ho(ia/bf);return o;}function cM(o,m){var fs=Math.sin(cp(o.latitude));var ia=bf*cp(o.longitude);var hT=bf/2*Math.log((1+fs)/(1-fs));var fd=cd(m);var l=new Msn.VE.Pixel();l.x=((fJ+ia)/fd);l.y=((fJ-hT)/fd);return l;}function du(e){if(e==undefined){e=c;}var m=e.zoomLevel;var d=e.center.x;var f=e.center.y;for(var a=0;a<t.length;a++){var iY=m-t[a].z1;var ac=H*Math.pow(2,iY);var fy=t[a].x1*ac;var fa=t[a].x2*ac;var fx=t[a].y1*ac;var eK=t[a].y2*ac;if(d>=fy&&d<=fa&&f>=fx&&f<=eK){if(m>=t[a].z1&&m<=t[a].z2){return t[a];}}}}function gg(e){var d=e.center.x;var f=e.center.y;var fj=0;for(var a=0;a<t.length;a++){var ac=H*Math.pow(2,e.zoomLevel-t[a].z1);var fy=t[a].x1*ac;var fa=t[a].x2*ac;var fx=t[a].y1*ac;var eK=t[a].y2*ac;if(d>=fy&&d<=fa&&f>=fx&&f<=eK){if(t[a].z2>=e.zoomLevel){return;}else if(t[a].z2>fj){fj=t[a].z2;}}}e.SetZoomLevel(fj);}this.IsValidTile=ft;this.GetFilename=hQ;this.MetersPerPixel=cd;this.PixelToLatLong=dj;this.LatLongToPixel=cM;this.GetBounds=du;this.ValidateZoomLevel=gg;}function oj(){var aw=document.createElement("div");var ae=document.createElement("div");var C=0,B=0,P=0,R=0;this.Init=function(){aw.className="ZoomBox_bg";ae.className="ZoomBox_fg";aw.attachEvent("onmouseup",bD);ae.attachEvent("onmouseup",bD);i.appendChild(aw);i.appendChild(ae);};this.Destroy=function(){aw.detachEvent("onmouseup",bD);ae.detachEvent("onmouseup",bD);i.removeChild(aw);i.removeChild(ae);};function hH(b){C=P=bl(b)-d+ai;B=R=ce(b)-f+ah;kT(C,B,1,1);aO();if(ae.setCapture){ae.setCapture();}}function id(b){P=bl(b)-d+ai;R=ce(b)-f+ah;kT(dR(C,P),dR(B,R),dV(1,aW(P-C)),dV(1,aW(R-B)));}function is(b){if(aW(C-P)>1&&aW(B-R)>1){var e=at.MakeCopy();e.SetZoomLevel(c.zoomLevel);e.SetPixelRectangle(new Msn.VE.PixelRectangle(new Msn.VE.Pixel(K+C,M+B),new Msn.VE.Pixel(K+P,M+R)));au(e);}as();if(ae.releaseCapture){ae.releaseCapture();}}function kT(d,f,aJ,aI){jR(aw,d+1,f+1,aJ,aI);jR(ae,d,f,aJ,aI);}function jR(aZ,d,f,aJ,aI){aZ.style.left=d+"px";aZ.style.top=f+"px";aZ.style.width=aJ+"px";aZ.style.height=aI+"px";}function aO(){aw.style.display="block";ae.style.display="block";}function as(){aw.style.display="none";ae.style.display="none";}this.OnMouseDown=hH;this.OnMouseMove=id;this.OnMouseUp=is;}function pH(){var gH=false;this.Init=function(){};this.Destroy=function(){};function hH(b){gH=false;iT=bl(b);iJ=ce(b);if(x.setCapture){x.setCapture();}var fE=K+ai+bl(b)-d;var fC=M+ah+ce(b)-f;ap("onstartcontinuouspan",fN(y.PixelToLatLong(new Msn.VE.Pixel(fE,fC),c.zoomLevel)));}function id(b){var cv=bl(b);var jE=ce(b);gP(iT-cv,iJ-jE);iT=cv;iJ=jE;gH=true;}function is(b){lU(true);if(x.releaseCapture){x.releaseCapture();}if(gH){ap("onendcontinuouspan");ap("onchangeview");gH=false;}var fE=K+ai+bl(b)-d;var fC=M+ah+ce(b)-f;var hl=fN(y.PixelToLatLong(new Msn.VE.Pixel(fE,fC),c.zoomLevel));ap("onmouseup",hl);ap("onclick",hl);}this.OnMouseDown=hH;this.OnMouseMove=id;this.OnMouseUp=is;}this.SetCenter=jj;this.SetMapStyle=cg;this.GetCenterLatitude=oY;this.GetCenterLongitude=pL;this.GetLatitude=iL;this.GetLongitude=hv;this.GetY=iZ;this.GetX=jc;this.LatLongToPixel=cM;this.PixelToLatLong=dj;this.GetZoomLevel=nq;this.GetMapStyle=ok;this.GetMetersPerPixel=mK;this.Resize=rm;this.PanMap=gP;this.ContinuousPan=gG;this.StopContinuousPan=fh;this.PanToLatLong=jK;this.AddPushpin=oJ;this.RemovePushpin=ng;this.ClearPushpins=pR;this.SetViewport=mt;this.SetBestMapView=kt;this.IncludePointInViewport=pQ;this.SetZoom=ri;this.ZoomIn=gL;this.ZoomOut=fU;this.SetCenterAndZoom=pf;this.AddLine=qR;this.RemoveLine=qz;this.ClearLines=jD;this.AttachEvent=dY;this.DetachEvent=ev;this.IsObliqueAvailable=oZ;this.GetObliqueScene=rg;this.SetAnimationEnabled=ph;this.IsAnimationEnabled=oz;this.SetObliqueScene=qL;this.SetObliqueOrientation=og;this.SetView=au;this.Debug=iy;this.GetResponseRangeCounts=pz;this.ResetResponseRangeCounts=pN;this.GetFailureRate=rp;};
Msn.VE.Bounds=function(fq,fp,C,B,P,R){this.z1=fq;this.z2=fp;this.x1=C;this.y1=B;this.x2=P;this.y2=R;};
Msn.VE.Dashboard=function(j,i,aV){var gF=document.createElement("div");var gx=document.createElement("div");var eG=document.createElement("div");var gk=null;var ms=document.createElement("hr");var bd=document.createElement("div");var cr=document.createElement("input");var jO=true;var bt=null;var dm=null;var ea=null;var cY=null;var bT=null;var cu=null;var iS=document.createElement("table");iS.className="dashboardContainerTable";var hX=document.createElement("tbody");var iK=document.createElement("tr");iS.appendChild(hX);hX.appendChild(iK);var iG=document.createElement("td");var dX=document.createElement("td");dX.vAlign="top";var en=document.createElement("td");en.colSpan=2;en.setAttribute("colspan",2);en.className="obliqueSelectorTable";iK.appendChild(iG);iK.appendChild(dX);var jB=document.createElement("tr");jB.appendChild(en);hX.appendChild(jB);this.Init=function(){var aa=i.GetMapStyle();iD(gF,"road",mJ);iD(gx,"aerial",lL);iD(eG,"bird's eye",ir);ms.className="Dashboard_separator";j.appendChild(ms);j.appendChild(iS);if(!aV||aV==Msn.VE.DashboardSize.Normal){bt=new re(iG,5,30);bt.Init();bt.Show();}dm=new qA(iG);dm.Hide();ea=new qZ(dX,100,30);ea.Init();cY=new pr(dX);oe();nQ();cu=new nW(en);cu.Init();i.AttachEvent("onendzoom",lQ);i.AttachEvent("onobliqueenter",jC);i.AttachEvent("onobliqueleave",mQ);i.AttachEvent("onchangemapstyle",ke);i.AttachEvent("onobliquechange",pU);if(i.IsObliqueAvailable()){jJ();}else{la();}switch(aa){case'r':kA();break;case'a':case'h':mI();break;case'o':kX();break;}};this.Destroy=function(){il(gF,mJ);il(gx,lL);il(eG,ir);gk=gF=gx=eG=null;bd.removeChild(cr);dX.removeChild(bd);bd.detachEvent("onclick",km);bd=cr=null;if(bt){bt.Destroy();bt=null;}if(cY){cY.Destroy();cY=null;}if(cu){cu.Destroy();cu=null;}if(i){i.DetachEvent("onendzoom",lQ);i.DetachEvent("onobliqueenter",jC);i.DetachEvent("onobliqueleave",mQ);i.DetachEvent("onchangemapstyle",ke);i=null;}};this.GetY=function(){return gJ(j);};this.GetHeight=function(){return j.offsetHeight;};function iD(bO,aP,de,rM){bO.className="Dashboard_tab Dashboard_unselected";bO.href="javascript:void(0)";bO.innerText=aP;bO.attachEvent("onclick",de);j.appendChild(bO);}function il(bO,de){bO.detachEvent("onclick",de);j.removeChild(bO);}function iE(bO){if(gk){gk.className="Dashboard_tab Dashboard_unselected";}bO.className="Dashboard_tab Dashboard_selected";gk=bO;}function oe(){cr.type="checkbox";bd.className="Dashboard_toggler";bd.style.display="none";bd.attachEvent("onclick",km);bd.appendChild(cr);bd.appendChild(document.createTextNode("Show labels"));dX.appendChild(bd);}function nQ(){bT=document.createElement("div");bT.className="Dashboard_notification";bT.innerHTML="<div id=\"obliqueNotifyIcon\">&nbsp;</div> There is Bird's Eye imagery available for this location.";bT.style.display="none";bT.onclick=ir;en.appendChild(bT);}function kA(){iE(gF);bd.style.display="none";cu.Hide();cY.Hide();ea.Show();if(i.IsObliqueAvailable()){bT.style.display="block";}if(bt){bt.Show();}dm.Hide();}function mI(){iE(gx);bd.style.display="block";cu.Hide();cY.Hide();ea.Show();if(i.GetMapStyle()=='h'){cr.checked=true;}else{cr.checked=false;}if(i.IsObliqueAvailable()){bT.style.display="block";}if(bt){bt.Show();}dm.Hide();}function kX(){iE(eG);bd.style.display="none";bT.style.display="none";cu.Show();ea.Hide();cY.Show();if(bt){bt.Hide();}dm.Show();}function jJ(){eG.className="Dashboard_tab Dashboard_unselected";bT.style.display="block";}function la(){eG.className="Dashboard_tab Dashboard_disabled";bT.style.display="none";}function mJ(){i.SetMapStyle('r');}function lL(){if(jO||cr.checked){i.SetMapStyle('h');}else{i.SetMapStyle('a');}jO=false;}function ir(){i.SetMapStyle('o');}function km(b){var aa=i.GetMapStyle();if(aa=='a'){i.SetMapStyle('h');cr.checked=true;}else if(aa=='h'){i.SetMapStyle('a');cr.checked=false;}}function lQ(b){ea.UpdateFromMap();cY.UpdateFromMap();}function jC(b){if(i.GetMapStyle()=="o"){return;}jJ();dm.UpdateFromMap();}function mQ(b){la();}function ke(b){switch(b.view.mapStyle){case'r':kA();break;case'a':case'h':mI();break;case'o':kX();break;}}function pU(b){cu.Update();dm.UpdateFromMap();}function re(L){var j=document.createElement("div");var d=0,f=0;var aQ=false;var cC=15;this.Init=function(){j.className="Compass";j.attachEvent("onmousedown",cR);j.attachEvent("onmouseup",bD);j.attachEvent("onmousemove",cL);j.attachEvent("ondblclick",G);L.appendChild(j);};this.Destroy=function(){j.detachEvent("onmousedown",cR);j.detachEvent("onmouseup",bD);j.detachEvent("onmousemove",cL);j.detachEvent("ondblclick",G);j=null;};function cR(b){b=ar(b);aG(b);d=iU(j);f=gJ(j);if(j.setCapture){j.setCapture();}var aE=bl(b)-d-(j.offsetWidth/2);var aH=ce(b)-f-(j.offsetHeight/2);aE=Math.min(Math.max(aE,-cC),cC);aH=Math.min(Math.max(aH,-cC),cC);i.ContinuousPan(aE,aH);aQ=true;return false;}function cL(b){b=ar(b);aG(b);if(aQ){var aE=bl(b)-d-(j.offsetWidth/2);var aH=ce(b)-f-(j.offsetHeight/2);aE=Math.min(Math.max(aE,-cC),cC);aH=Math.min(Math.max(aH,-cC),cC);i.ContinuousPan(aE,aH);}return false;}function bD(b){b=ar(b);aG(b);if(j.releaseCapture){j.releaseCapture();}i.StopContinuousPan();aQ=false;return false;}function as(){j.style.display="none";}function aO(){j.style.display="block";}this.Hide=as;this.Show=aO;}function nW(L){var j=document.createElement("table");var u=new Array(3);this.Init=function(){j.className="obliqueSelectorTable";as();L.appendChild(j);var jd=document.createElement("tbody");jd.className="obliqueSelectorTable";j.appendChild(jd);for(var a=0;a<3;a++){var mR=document.createElement("tr");jd.appendChild(mR);u[a]=new Array(3);for(var Y=0;Y<3;Y++){var ao=document.createElement("div");var al=document.createElement("td");mR.appendChild(al);al.appendChild(ao);ao.className="Dashboard_thumbnail";if(a==1&&Y==1){u[a][Y]=new lK(ao,false);al.className="obliqueSelectorCellCenter";}else{u[a][Y]=new lK(ao,true);al.className="obliqueSelectorCellOff";}u[a][Y].Init();}}};this.Destroy=function(){L.removeChild(j);j=null;for(var a=0;a<u.length;a++){for(var Y=0;Y<u[a].length;Y++){u[a][Y].Destroy();u[a][Y]=null;}}u=null;};function aO(){cl();j.style.display="block";}function as(){j.style.display="none";}function cl(){var g=i.GetObliqueScene();if(!g){return;}u[1][1].SetScene(g);switch(g.GetOrientation()){case"North":u[0][0].SetScene(g.GetNeighbor("Northwest"));u[0][1].SetScene(g.GetNeighbor("North"));u[0][2].SetScene(g.GetNeighbor("Northeast"));u[1][0].SetScene(g.GetNeighbor("West"));u[1][2].SetScene(g.GetNeighbor("East"));u[2][0].SetScene(g.GetNeighbor("Southwest"));u[2][1].SetScene(g.GetNeighbor("South"));u[2][2].SetScene(g.GetNeighbor("Southeast"));break;case"East":u[0][0].SetScene(g.GetNeighbor("Northeast"));u[0][1].SetScene(g.GetNeighbor("East"));u[0][2].SetScene(g.GetNeighbor("Southeast"));u[1][0].SetScene(g.GetNeighbor("North"));u[1][2].SetScene(g.GetNeighbor("South"));u[2][0].SetScene(g.GetNeighbor("Northwest"));u[2][1].SetScene(g.GetNeighbor("West"));u[2][2].SetScene(g.GetNeighbor("Southwest"));break;case"West":u[0][0].SetScene(g.GetNeighbor("Southwest"));u[0][1].SetScene(g.GetNeighbor("West"));u[0][2].SetScene(g.GetNeighbor("Northwest"));u[1][0].SetScene(g.GetNeighbor("South"));u[1][2].SetScene(g.GetNeighbor("North"));u[2][0].SetScene(g.GetNeighbor("Southeast"));u[2][1].SetScene(g.GetNeighbor("East"));u[2][2].SetScene(g.GetNeighbor("Northeast"));break;case"South":u[0][0].SetScene(g.GetNeighbor("Southeast"));u[0][1].SetScene(g.GetNeighbor("South"));u[0][2].SetScene(g.GetNeighbor("Southwest"));u[1][0].SetScene(g.GetNeighbor("East"));u[1][2].SetScene(g.GetNeighbor("West"));u[2][0].SetScene(g.GetNeighbor("Northeast"));u[2][1].SetScene(g.GetNeighbor("North"));u[2][2].SetScene(g.GetNeighbor("Northwest"));break;}}function lK(ao,dQ){var g=null;this.Init=function(){ao.title="Select a thumbnail to display an image from the surrounding area.";if(dQ){ao.attachEvent("onclick",gI);ao.attachEvent("onmouseover",eL);ao.attachEvent("onmouseout",gA);}};this.Destroy=function(){if(dQ){ao.detachEvent("onclick",gI);ao.detachEvent("onmouseover",eL);ao.detachEvent("onmouseout",gA);}};this.SetScene=function(s){g=s;if(g){ao.innerHTML="<img src=\""+g.GetThumbnailFilename()+"\" width=48 height=48 border=0>";if(dQ){ao.style.cursor="pointer";}}else{ao.innerHTML="";ao.style.cursor="default";}if(dQ){ao.parentNode.className="obliqueSelectorCellOff";}};function gI(){if(!g){return;}i.SetObliqueScene(g.GetID());}function eL(b){ao.parentNode.className="obliqueSelectorCellOn";}function gA(b){ao.parentNode.className="obliqueSelectorCellOff";}}this.Update=cl;this.Show=aO;this.Hide=as;}function qZ(L){var w=document.createElement("div");var dI=document.createElement("div");var bz=document.createElement("div");var X=document.createElement("div");var cJ=document.createElement("div");var d=0,f=0;var cW=false;this.Init=function(){cJ.className="ZoomBar_minus";cJ.unselectable="on";cJ.attachEvent("onclick",lI);X.className="ZoomBar_slider";X.unselectable="on";X.attachEvent("onmousedown",cR);X.attachEvent("onmousemove",cL);X.attachEvent("onmouseup",bD);X.attachEvent("onclick",G);bz.className="ZoomBar_bar";bz.unselectable="on";bz.appendChild(X);bz.attachEvent("onclick",jp);dI.className="ZoomBar_plus";dI.unselectable="on";dI.attachEvent("onclick",ju);w.className="ZoomBar";w.appendChild(cJ);w.appendChild(bz);w.appendChild(dI);w.attachEvent("onmousedown",G);w.attachEvent("onmouseup",G);w.attachEvent("onclick",G);w.attachEvent("ondblclick",G);L.appendChild(w);cQ();};this.Destroy=function(){cJ.detachEvent("onclick",lI);X.detachEvent("onmousedown",cR);X.detachEvent("onmousemove",cL);X.detachEvent("onmouseup",bD);X.detachEvent("onclick",G);bz.removeChild(X);bz.detachEvent("onclick",jp);dI.detachEvent("onclick",ju);w.removeChild(dI);w.removeChild(bz);w.removeChild(cJ);w.detachEvent("onmousedown",G);w.detachEvent("onmousedown",G);w.detachEvent("onclick",G);w.detachEvent("ondblclick",G);L.removeChild(w);i.DetachEvent("onendzoom",cQ);cJ=X=bz=dI=w=L=i=null;};function aO(){w.style.display="block";}function as(){w.style.display="none";}function mM(){d=iU(w);f=gJ(w);}function cR(b){b=ar(b);aG(b);mM();if(X.setCapture){X.setCapture();}cW=true;return false;}function cL(b){b=ar(b);aG(b);if(cW){X.style.left=ig(bl(b))+"px";}return false;}function bD(b){b=ar(b);aG(b);if(X.releaseCapture){X.releaseCapture();}cW=false;jP(ig(bl(b)));return false;}function ju(b){i.ZoomIn();}function lI(b){i.ZoomOut();}function jp(b){b=ar(b);aG(b);mM();jP(ig(bl(b)));return false;}function ig(cv){cv-=d+cJ.offsetWidth+X.offsetWidth;var aA=bz.offsetWidth-X.offsetWidth;if(cv<0){cv=0;}else if(cv>aA){cv=aA;}return cv;}function jP(aq){var aA=bz.offsetWidth-X.offsetWidth;var ch=1+aj(aq/aA*18);i.SetZoom(ch);}function cQ(){var aA=bz.offsetWidth-X.offsetWidth;var aq=(i.GetZoomLevel()-1)/18*aA;X.style.left=aq+"px";}this.UpdateFromMap=cQ;this.Show=aO;this.Hide=as;}function pr(L){var w=document.createElement("div");var bH=document.createElement("div");var bG=document.createElement("div");w.title="Select the desired zoom level for the image.";w.setAttribute("id","obliqueZoomContainer");bH.setAttribute("id","obliqueZoomSmall");bH.className="obliqueZoomSmallOn";bG.setAttribute("id","obliqueZoomLarge");bG.className="obliqueZoomLargeOff";bH.attachEvent("onclick",kD);bG.attachEvent("onclick",jN);w.appendChild(bH);w.appendChild(bG);L.appendChild(w);function aO(){w.style.display="block";}function as(){w.style.display="none";}function kD(b){i.ZoomOut();bH.className="obliqueZoomSmallOn";bG.className="obliqueZoomLargeOff";}function jN(b){i.ZoomIn();bH.className="obliqueZoomSmallOff";bG.className="obliqueZoomLargeOn";}function bZ(){bH.detachEvent("onclick",kD);bG.detachEvent("onclick",jN);w.removeChild(bH);w.removeChild(bG);bH=null;bG=null;w.parentNode.removeChild(w);w=null;}function cQ(){if(i.GetZoomLevel()==1){bH.className="obliqueZoomSmallOn";bG.className="obliqueZoomLargeOff";}else{bH.className="obliqueZoomSmallOff";bG.className="obliqueZoomLargeOn";}}this.Destroy=bZ;this.Show=aO;this.Hide=as;this.UpdateFromMap=cQ;}function gT(F,qd,aq){var j=document.createElement("div");j.setAttribute("id",F);j.innerHTML=qd;var fF="obliqueCompassPointOff";var kF=aq;j.onmouseover=eL;j.onmouseout=gA;j.onclick=gI;this.onclick=null;this.onmouseover=null;this.onmouseout=null;var el=this;var fb=false;var ll=new nK(j,17,17);function eL(b){if(fb){return;}fF=j.className;j.className="obliqueCompassPointHover";if(el.onmouseover){el.onmouseover(b);}}function gI(b){if(fb){return;}eL(b);fF="obliqueCompassPointOn";if(el.onclick){el.onclick(b);}}function gA(b){if(fb){return;}j.className=fF;if(el.onmouseout){el.onmouseout(b);}}function lg(){fF="obliqueCompassPointOn";j.className="obliqueCompassPointOn";}function jA(){fF="obliqueCompassPointOff";j.className="obliqueCompassPointOff";}function ps(){fb=true;jA();}function lV(){fb=false;lg();}function qn(){return j;}function oC(){return kF;}function nx(aq){kF=aq;}function iH(){ll.Reset();lV();}function po(lk){j.style.left=lk.left;j.style.top=lk.top;}function nK(bJ,nh,nA){var j=bJ;var cc=0;var gu=0.3;var ht=0;var on=40;var kO=25;var gK=false;var pZ=Math.PI/2;var kv=true;var gs=gu+0.1;function nu(gs,jW,jU){if(jW>=jU-gs&&jW<=jU+gs){return true;}return false;}function kS(){cc+=gu;if(cc>Math.PI*2)cc-=Math.PI*2;else if(cc<0){cc+=Math.PI*2}if(nu(gs,cc,ht)){gu=0.3;cc=ht;jm(cc);gK=false;return;}jm(cc);window.setTimeout(kS,on);}function jm(dJ){var d=nh+(kO*Math.sin(dJ));var f=nA+(kO*Math.cos(dJ));j.style.left=d+"px";j.style.top=f+"px";}function kx(dJ){if(gK)return;gK=true;ht=dJ;kS();}function oo(ih,ou){kv=ou;if(!kv){gu*=-1;}kx(pZ*ih);}function iH(){gK=false;cc=0;}this.RotateTo=kx;this.RotateToIndex=oo;this.Reset=iH;}function bZ(){j.parentNode.removeChild(j);j.onmouseover=null;j.onmouseout=null;j.onclick=null;j=null;}this.GetElement=qn;this.GetCurrentPositionIndex=oC;this.SetCurrentPositionIndex=nx;this.SetCurrentPosition=po;this.On=lg;this.Off=jA;this.RotateToIndex=ll.RotateToIndex;this.Reset=iH;this.Disable=ps;this.Enable=lV;this.Destroy=bZ;}function qA(w){var ga=new Array();ga.push({"top":"-8px","left":"17px"});ga.push({"top":"17px","left":"42px"});ga.push({"top":"42px","left":"17px"});ga.push({"top":"17px","left":"-8px"});var bm=document.createElement("div");bm.setAttribute("id","obliqueCompassContainer");bm.title="Select the direction you want to look toward.";var az=new gT("obliqueCompassPointN","N",0);az.onclick=qu;az.onmouseover=py;az.onmouseout=fm;var aC=new gT("obliqueCompassPointE","E",1);aC.onclick=qG;aC.onmouseover=qb;aC.onmouseout=fm;var aD=new gT("obliqueCompassPointS","S",2);aD.onclick=pC;aD.onmouseover=pD;aD.onmouseout=fm;var aB=new gT("obliqueCompassPointW","W",3);aB.onclick=nD;aB.onmouseover=qB;aB.onmouseout=fm;var fg=document.createElement("div");bm.appendChild(az.GetElement());bm.appendChild(aC.GetElement());bm.appendChild(aD.GetElement());bm.appendChild(aB.GetElement());bm.appendChild(fg);w.appendChild(bm);cQ();function gC(aq){if(aq<0){aq=4-Math.abs(aq);}return aq;}function dc(nj){var aq=nj.GetCurrentPositionIndex();aC.SetCurrentPositionIndex(gC(aC.GetCurrentPositionIndex()-aq));aB.SetCurrentPositionIndex(gC(aB.GetCurrentPositionIndex()-aq));az.SetCurrentPositionIndex(gC(az.GetCurrentPositionIndex()-aq));aD.SetCurrentPositionIndex(gC(aD.GetCurrentPositionIndex()-aq));var fk=true;if(aq==3){fk=false;}az.RotateToIndex(2-az.GetCurrentPositionIndex()<0?az.GetCurrentPositionIndex():2-az.GetCurrentPositionIndex(),fk);aC.RotateToIndex(2-aC.GetCurrentPositionIndex()<0?aC.GetCurrentPositionIndex():2-aC.GetCurrentPositionIndex(),fk);aD.RotateToIndex(2-aD.GetCurrentPositionIndex()<0?aD.GetCurrentPositionIndex():2-aD.GetCurrentPositionIndex(),fk);aB.RotateToIndex(2-aB.GetCurrentPositionIndex()<0?aB.GetCurrentPositionIndex():2-aB.GetCurrentPositionIndex(),fk);}function cx(ih){switch(ih){case 0:fm();break;case 1:nd();break;case 2:om();break;case 3:oy();break;}}function fm(){fg.className="obliqueCompassArrowU";}function om(){fg.className="obliqueCompassArrowD";}function nd(){fg.className="obliqueCompassArrowR";}function oy(){fg.className="obliqueCompassArrowL";}function pC(b){dc(aD);cx(0);var g=i.GetObliqueScene();if(g){var dq=g.GetRotation("South");if(dq){i.SetObliqueOrientation("South");}}}function qu(b){dc(az);cx(0);var g=i.GetObliqueScene();if(g){var dq=g.GetRotation("North");if(dq){i.SetObliqueOrientation("North");}}}function qG(b){dc(aC);cx(0);var g=i.GetObliqueScene();if(g){var dq=g.GetRotation("East");if(dq){i.SetObliqueOrientation("East");}}}function nD(b){dc(aB);cx(0);var g=i.GetObliqueScene();if(g){var dq=g.GetRotation("West");if(dq){i.SetObliqueOrientation("West");}}}function pD(b){cx(aD.GetCurrentPositionIndex());}function qb(b){cx(aC.GetCurrentPositionIndex());}function qB(b){cx(aB.GetCurrentPositionIndex());}function py(b){cx(az.GetCurrentPositionIndex());}function as(){bm.style.display="none";}function aO(){bm.style.display="block";}function cQ(){var g=i.GetObliqueScene();if(!g){return;}switch(g.GetOrientation()){case"North":dc(az);break;case"South":dc(aD);break;case"East":dc(aC);break;case"West":dc(aB);break;}cx(0);if(g.GetRotation("North")){az.Enable();}else{az.Disable();}if(g.GetRotation("South")){aD.Enable();}else{aD.Disable();}if(g.GetRotation("East")){aC.Enable();}else{aC.Disable();}if(g.GetRotation("West")){aB.Enable();}else{aB.Disable();}}function bZ(){az.Destroy();aC.Destroy();aD.Destroy();aB.Destroy();bm.parentNode.removeChild(bm);bm=null;}this.Hide=as;this.Show=aO;this.UpdateFromMap=cQ;}};
Msn.VE.DashboardSize=new function(){this.Normal="normal";this.Small="small";this.Tiny="tiny";};
Msn.VE.LatLong=function(A,J){this.latitude=A;this.longitude=J;this.ToString=function(){return"("+this.latitude+", "+this.longitude+")";};this.Copy=function(o){if(!o){return;}this.latitude=o.latitude;this.longitude=o.longitude;};};
Msn.VE.LatLongRectangle=function(iW,iP){this.northwest=iW;this.southeast=iP;this.ToString=function(){return"("+(this.northwest?this.northwest.ToString():"null")+", "+(this.southeast?this.southeast.ToString():"null")+")";};this.Copy=function(bv){if(!bv){return;}if(!this.northwest){this.northwest=new Msn.VE.LatLong();}if(!this.southeast){this.southeast=new Msn.VE.LatLong();}this.northwest.Copy(bv.northwest);this.southeast.Copy(bv.southeast);};this.Center=function(){var eX=Math.sin(this.northwest.latitude*Math.PI/180.0);var eU=Math.sin(this.southeast.latitude*Math.PI/180.0);var qe=0.25*(Math.log((1.0+eX)/(1.0-eX))+Math.log((1.0+eU)/(1.0-eU)));var bU=new Msn.VE.LatLong();bU.latitude=Math.atan(Math.exp(qe))*360.0/Math.PI-90.0;bU.longitude=0.5*(this.northwest.longitude+this.southeast.longitude);return bU;};this.Contains=function(o){return o.latitude<=iW.latitude&&o.longitude>=iW.longitude&&o.latitude>=iP.latitude&&o.longitude<=iP.longitude;};};
Msn.VE.MapStyle=new function(){this.Road="r";this.Aerial="a";this.Hybrid="h";this.Oblique="o";};
Msn.VE.MapView=function(){this.zoomLevel=0;this.mapStyle=null;this.center=new Msn.VE.Pixel();this.latlong=new Msn.VE.LatLong();this.pixelRect=new Msn.VE.PixelRectangle();this.latlongRect=new Msn.VE.LatLongRectangle();this.sceneId=null;this.sceneOrientation=null;var h=this;var bI="pixel";this.Destroy=function(){this.center=this.latlong=h=null;};this.GetViewType=function(){return bI;};function mY(){var kg=new Msn.VE.MapView();kg.Copy(h);return kg;}function oA(e){h.zoomLevel=e.zoomLevel;h.mapStyle=e.mapStyle;h.center.Copy(e.center);h.latlong.Copy(e.latlong);h.pixelRect.Copy(e.pixelRect);h.latlongRect.Copy(e.latlongRect);h.sceneId=e.sceneId;h.sceneOrientation=e.sceneOrientation;bI=e.GetViewType();}function oa(e){return e!=null&&h.zoomLevel==e.zoomLevel&&h.mapStyle==e.mapStyle&&aW(h.center.x-e.center.x)<0.000001&&aW(h.center.y-e.center.y)<0.000001&&h.sceneId==e.sceneId&&h.sceneOrientation==e.sceneOrientation;}function hU(){return"("+h.latlong.ToString()+", "+h.zoomLevel+", "+h.mapStyle+")";}function jj(l){if(!l){return;}h.center=l;bI="pixel";}function pd(o){if(!o){return;}h.latlong=o;bI="latlong";}function qO(nR){h.pixelRect=nR;bI="pixelRect";}function rc(pM){h.latlongRect=pM;bI="latlongRect";}function kf(m){if(m<=0){return;}switch(bI){case"pixel":var ac=Math.pow(2,m-h.zoomLevel);h.center.x*=ac;h.center.y*=ac;break;case"pixelRect":var ac=Math.pow(2,m-h.zoomLevel);h.pixelRect.topLeft.x*=ac;h.pixelRect.topLeft.y*=ac;h.pixelRect.bottomRight.x*=ac;h.pixelRect.bottomRight.y*=ac;break;}h.zoomLevel=m;}function cg(aa,bV,iq){h.mapStyle=aa;if(bI=="pixel"){bI="latlong";}if(aa!='o'){h.sceneId=null;h.sceneOrientation=null}else{h.sceneId=bV;h.sceneOrientation=iq;}}function jc(m){if(m){return h.center.x*Math.pow(2,m-h.zoomLevel);}return h.center.x;}function iZ(m){if(m){return h.center.y*Math.pow(2,m-h.zoomLevel);}return h.center.y;}function ny(m){if(m==undefined){return h.center;}return new Msn.VE.Pixel(h.GetX(m),h.GetY(m));}function ru(bi,q,p){switch(bI){case"pixel":h.latlong=bi.PixelToLatLong(h.center,h.zoomLevel);break;case"latlong":h.center=bi.LatLongToPixel(h.latlong,h.zoomLevel);break;case"pixelRect":hN(bi,q,p);break;case"latlongRect":if(h.mapStyle=="o"){h.zoomLevel=1;var g=bi.GetScene();if(!g.ContainsLatLong(h.latlongRect.northwest)||!g.ContainsLatLong(h.latlongRect.southeast)){h.latlong=h.latlongRect.Center();h.center=bi.LatLongToPixel(h.latlong,h.zoomLevel);}else{h.pixelRect.topLeft=bi.LatLongToPixel(h.latlongRect.northwest,h.zoomLevel);h.pixelRect.bottomRight=bi.LatLongToPixel(h.latlongRect.southeast,h.zoomLevel);hN(bi,q,p);}}else{h.zoomLevel=12;h.pixelRect.topLeft=bi.LatLongToPixel(h.latlongRect.northwest,h.zoomLevel);h.pixelRect.bottomRight=bi.LatLongToPixel(h.latlongRect.southeast,h.zoomLevel);hN(bi,q,p);}break;}bI="pixel";}function hN(bi,q,p){var hO=19;var T=Math.pow(2,hO-h.zoomLevel);var qT=dV(1,aW(h.pixelRect.topLeft.x-h.pixelRect.bottomRight.x)*T);var pg=dV(1,aW(h.pixelRect.topLeft.y-h.pixelRect.bottomRight.y)*T);var lZ=Math.log(2);var qw=hO-Math.ceil(Math.log(qT/q)/lZ);var pp=hO-Math.ceil(Math.log(pg/p)/lZ);var bo=dR(qw,pp);T=Math.pow(2,bo-h.zoomLevel);h.center.x=0.5*(h.pixelRect.topLeft.x+h.pixelRect.bottomRight.x)*T;h.center.y=0.5*(h.pixelRect.topLeft.y+h.pixelRect.bottomRight.y)*T;h.zoomLevel=bo;h.latlong=bi.PixelToLatLong(h.center,h.zoomLevel);}this.MakeCopy=mY;this.Copy=oA;this.Equals=oa;this.ToString=hU;this.SetCenter=jj;this.SetCenterLatLong=pd;this.SetPixelRectangle=qO;this.SetLatLongRectangle=rc;this.SetZoomLevel=kf;this.SetMapStyle=cg;this.GetX=jc;this.GetY=iZ;this.GetCenter=ny;this.Resolve=ru;this.SetZoomLevel=kf;};
Msn.VE.ObliqueScene=function(F,bK,qX,eH,nY,nE,eD,gD,oO,qM,nZ,nz){var H=256;var t=new Msn.VE.Bounds(1,2,0,0,eD/2,gD/2);function dj(l,m){var T=Math.pow(2,m-2);var je=[[l.x/T],[l.y/T],[1]];var aU=ma(oO,je);var o=new Msn.VE.LatLong();o.longitude=aU[0][0]/aU[2][0];o.latitude=aU[1][0]/aU[2][0];return o;}function cM(o,m){var T=Math.pow(2,m-2);var je=[[o.longitude],[o.latitude],[1]];var aU=ma(qM,je);var l=new Msn.VE.Pixel();l.x=aU[0][0]/aU[2][0]*T;l.y=aU[1][0]/aU[2][0]*T;return l;}function ft(Z,ab,m){if(Z<0||ab<0){return false;}if(m==1){return Z<(eD/2)&&ab<(gD/2);}return Z<eD&&ab<gD;}function qW(){return F;}function rv(Z,ab,m){var pv=ab*(m==1?eD/2:eD)+Z;return"http://c"+(Z%2)+".p"+nE+".oblique.tiles.virtualearth.net/tiles/o"+bK+"-"+qX+"-"+(nY+m-2)+"-"+pv+".jpeg?g=24";}function rq(){return"http://thumbs.oblique.tiles.virtualearth.net/tiles/ot"+F+".jpeg?g=24";}function qf(a){var bV=nZ[a];if(bV==null||bV==-1){return null;}return new Msn.VE.ObliqueScene(bV);}function nF(a){var bV=nz[a];if(bV==null||bV==-1){return null;}return new Msn.VE.ObliqueScene(bV);}function qy(){return eH;}function du(){return t;}function lv(){return eD*H;}function go(){return gD*H;}function pq(o){if(!o){return false;}var l=cM(o,2);return jQ(l,2);}function jQ(l,m){var T=Math.pow(2,2-m);var d=l.x*T;var f=l.y*T;return d>=0&&f>=0&&d<lv()&&f<go();}this.PixelToLatLong=dj;this.LatLongToPixel=cM;this.IsValidTile=ft;this.GetID=qW;this.GetTileFilename=rv;this.GetThumbnailFilename=rq;this.GetNeighbor=qf;this.GetRotation=nF;this.GetOrientation=qy;this.GetBounds=du;this.GetWidth=lv;this.GetHeight=go;this.ContainsLatLong=pq;this.ContainsPixel=jQ;};
Msn.VE.Orientation=new function(){this.North="North";this.East="East";this.West="West";this.South="South";};
Msn.VE.Pixel=function(d,f){this.x=d;this.y=f;this.ToString=function(){return"("+this.x+", "+this.y+")";};this.Copy=function(l){if(!l){return;}this.x=l.x;this.y=l.y;};};
Msn.VE.PixelRectangle=function(nC,qD){this.topLeft=nC;this.bottomRight=qD;this.ToString=function(){return"("+(this.topLeft?this.topLeft.ToString():"null")+", "+(this.bottomRight?this.bottomRight.ToString():"null")+")";};this.Copy=function(bv){if(!bv){return;}if(!this.topLeft){this.topLeft=new Msn.VE.Pixel();}if(!this.bottomRight){this.bottomRight=new Msn.VE.Pixel();}this.topLeft.Copy(bv.topLeft);this.bottomRight.Copy(bv.bottomRight);};};
Msn.VE.LineRegion=function(nX,cH,ni){this.boundingRectangle=nX;this.indices=cH;this.childRegions=ni;function hU(){return"Bounding Rectangle: "+this.boundingRectangle[0].ToString()+" to "+this.boundingRectangle[1].ToString()+" | Indices: ["+cH+"]";};this.ToString=hU;}
OAT.Loader.pendingCount--;
